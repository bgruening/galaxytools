<tool id="snpSift_geneSets" name="SnpSift GeneSets" version="3.6">
    <description>Annotating GeneSets, such as Gene Ontology, KEGG, Reactome</description>
    <!-- 
        You can change the amount of memory used, just change the -Xmx parameter (e.g. use -Xmx2G for 2Gb of memory)
    -->
    <expand macro="requirements" />
    <macros>
        <import>snpEff_macros.xml</import>
    </macros>
    <command>
        java -Xmx2G -jar \$SNPEFF_JAR_PATH/SnpSift.jar geneSets -v
        #if $db_opts.db_opts_selector == "db"
          "${db_opts.database.fields.path}"
        #elif $db_opts.db_opts_selector == "histdb"
          "$db_opts.histdb"
        #end if
        
        $input 2&gt; $log &gt; $output
    </command>
    <inputs>
        <param format="vcf" name="input" type="data" label="Variant input file in VCF format"/>
        <conditional name="db_opts">
            <param name="db_opts_selector" type="select" label="Select Annotation database" help="">
              <option value="db" selected="True">Locally installed database</option>
              <option value="histdb">database from your history</option>
            </param>
            <when value="db">
                <param name="database" type="select" label="Molecular Signatures Database (MSigDB)">
                    <options from_file="snpeff_msigdb_database.loc">
                      <column name="value" index="0"/>
                      <column name="name" index="1"/>
                      <column name="path" index="2"/>
                    </options>
                </param>
                <param name="histdb" type="hidden" value="" />
            </when>
            <when value="histdb">
                <param name="histdb" type="data" format="txt" label="Molecular Signatures Database (MSigDB)" />
            </when>
        </conditional>
    </inputs>
    <outputs>
        <data format="vcf" name="${tool.name} on ${on_string}: VCF" />
        <data format="txt" name="log" label="${tool.name} on ${on_string}: log" />
    </outputs>
    <expand macro="stdio" />
    <tests>
    </tests>
    <help>
This tool uses `SnpSift GeneSets`_ to add annotations from `MSigDB`_, a collection of annotated gene sets from different sources including Gene Ontology (GO), KEGG, Reactome.

.. _SnpSift GeneSets: http://snpeff.sourceforge.net/SnpSift.html#geneSets

.. class:: warningmark

The input VCF file must be annotated using SnpEff before performing GeneSets annotations. This is because the tool must know which gene the variant affects.

@EXTERNAL_DOCUMENTATION@

    </help>
    <expand macro="citations">
        <citation type="doi">10.1073/pnas.0506580102</citation><!-- MSigDB citation -->
    </expand>
</tool>
