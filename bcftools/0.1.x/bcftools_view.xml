<tool id="bcfview" name="bcftoolsView" version="0.1.19">
    <description>Convert, filter, subset VCF/BCF files</description>
    <expand macro="version_command" />
    <expand macro="stdio" />
    <macros>
        <token name="@EXECUTABLE@">bcftools</token>
        <import>bcftools_macros.xml</import>
    </macros>
    <command>
        @EXECUTABLE@ view $A $varsitesonly $snpcalling $F $G $N $e $g
        #if str( $output_format ) == "bcf":
            -b
        #end if
        #if $D.seq_dictionary == "true":
            -D "$D.input"
        #end if
        #if $i.alt_indel_snp_ratio == "true":
            -i $i.ratio
        #end if
        #if $t.mutation_rate == "true":
            -t $t.rate
        #end if

        $input 

        &gt; $output

    </command>
    <inputs>
        <param name="input" type="data" format="bcf,vcf" label="Choose a bcf file to view" />
        <param name="output_format" type="select" label="Choose the output format" help="-b">
            <option value="vcf" selected="true">VCF</option>
            <option value="bcf">BCF</option>
        </param>
        <conditional name="D">
            <param name="seq_dictionary" type="select" label="Sequence dictionary (list of chromosome names) for VCF->BCF conversion" help="-D">
                <option value="true">Yes</option>
                <option value="false" selected="true">No</option>
            </param>
            <when value="true">
                <param name="input" type="data" format="tabular" label="Sequence dictionary" />
            </when>
        </conditional>
        <conditional name="i">
            <param name="alt_indel_snp_ratio" type="select" label="Use alternate INDEL-to-SNP mutation rate, default 0.15" help="-i">
                <option value="true">Yes</option>
                <option value="false" selected="true">No</option>
            </param>
            <when value="true">
                <param name="ratio" type="float" label="Ratio" value="0.15" />
            </when>
        </conditional>

        <conditional name="t">
            <param name="mutation_rate" type="select" label="Specify scaled mutation rate for variant calling, default is 0.001.">
                <option value="true">Yes</option>
                <option value="false" selected="true">No</option>
            </param>
            <when value="true">
                <param name="rate" type="float" label="Mutation Rate (float)" value="0.001" />
            </when>
        </conditional>
        <param name="A" type="boolean" truevalue="-A" falsevalue="" checked="False"
             label="Retain all possible alternate alleles at variant sites" help="-A" />
        <param name="varsitesonly" type="boolean" truevalue="-v" falsevalue="" checked="false" label="Output Potential Variant Sites Only" help="-v"/>
        <param name="snpcalling" type="boolean" truevalue="-c" falsevalue="" checked="false" label="SNP calling (forces -e)" help="-c"/>
        <param name="F" type="boolean" truevalue="-F" falsevalue="" checked="False"
            label="Indicate PL is generated by r921 or before (ordering is different)" help="-F" />
        <param name="G" type="boolean" truevalue="-G" falsevalue="" checked="False"
            label="Suppress all individual genotype information" help="-G" />
        <param name="N" type="boolean" truevalue="-N" falsevalue="" checked="False"
            label="Skip sites where the REF field is not A/C/G/T" help="-N" />
        <!-- behaviour of this was not tested with respect to the -b flag ... <param name="u" type="boolean" truevalue="-u" falsevalue="" checked="False"
                label="Uncompressed BCF output" help="-u" />
        -->
        <param name="e" type="boolean" truevalue="-e" falsevalue="" checked="False"
            label="Perform max-likelihood inference only, including estimating the site allele frequency, testing Hardy-Weinberg equilibrium and testing associations with LRT."
            help="-e" />
        <param name="g" type="boolean" truevalue="-g" falsevalue="" checked="True"
            label="Call per-sample genotypes at variant sites" help="-g" />
    </inputs>

    <outputs>
        <data format="bcf" name="output">
            <change_format>
                <when input="output_format" value="vcf" format="vcf" />
            </change_format>
        </data>
    </outputs>

    <tests>
    </tests>

    <help>
**BCFTools View**

VCF/BCF conversion, view, subset and filter VCF/BCF files.


**Input format**

bcf files

------

**Outputs**

compressed or uncompressed VCF or BCF files

@CITATION@
    </help>

    <expand macro="citations"/>
</tool>
