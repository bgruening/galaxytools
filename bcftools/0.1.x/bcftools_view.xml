<tool id="bcftools_@EXECUTABLE@" name="bcftools @EXECUTABLE@" version="0.1.19.0">
    <description>Convert, filter, subset VCF/BCF files</description>
    <expand macro="requirements" />
    <expand macro="version_command" />
    <expand macro="stdio" />
    <macros>
        <token name="@EXECUTABLE@">view</token>
        <import>bcftools_macros.xml</import>
    </macros>
    <command>
<![CDATA[
        bcftools @EXECUTABLE@
            $A
            $varsitesonly
            $snpcalling
            ##$F
            $G
            $N
            $e
            $g

            #if str( $output_format ) == "bcf":
                -b
            #end if

            -D $seq_dict

            -i $ratio
            -t $rate

            $input
            > $output

]]>
    </command>
    <inputs>
        <param name="input" type="data" format="bcf,vcf" label="Choose a bcf file to view" />
        <param name="output_format" type="select" label="Choose the output format" help="-b">
            <option value="vcf" selected="true">VCF</option>
            <option value="bcf">BCF</option>
        </param>

        <param name="seq_dict" type="data" format="tabular" optional="True" label="List of chromosome names for conversion" help="(-D)" />

        <param name="ratio" type="float" label="Use alternate INDEL-to-SNP mutation rate" value="-1" help="defaults to 0.15 (-i)" />
        <param name="rate" type="float" label="Mutation rate for variant calling" value="0.001" help="default to 0.001 (-t)" />

        <param name="A" type="boolean" truevalue="-A" falsevalue="" checked="False"
             label="Retain all possible alternate alleles at variant sites" help="-A" />
        <param name="varsitesonly" type="boolean" truevalue="-v" falsevalue="" checked="false" label="Output Potential Variant Sites Only" help="-v"/>
        <param name="snpcalling" type="boolean" truevalue="-c" falsevalue="" checked="false" label="SNP calling" help="Forces -e the max-likelihood inference parameter. (-c)"/>
        <!--param name="F" type="boolean" truevalue="-F" falsevalue="" checked="False"
            label="Indicate PL is generated by r921 or before (ordering is different)" help="-F" /-->
        <param name="G" type="boolean" truevalue="-G" falsevalue="" checked="False"
            label="Suppress all individual genotype information" help="-G" />
        <param name="N" type="boolean" truevalue="-N" falsevalue="" checked="False"
            label="Skip sites where the REF field is not A/C/G/T" help="-N" />
        <param name="e" type="boolean" truevalue="-e" falsevalue="" checked="False"
            label="Perform max-likelihood inference only"
            help="Including estimating the site allele frequency, testing Hardy-Weinberg equilibrium and testing associations with LRT. (-e)" />
        <param name="g" type="boolean" truevalue="-g" falsevalue="" checked="True"
            label="Call per-sample genotypes at variant sites" help="-g" />
    </inputs>

    <outputs>
        <data format="bcf" name="output">
            <change_format>
                <when input="output_format" value="vcf" format="vcf" />
            </change_format>
        </data>
    </outputs>

    <tests>
    </tests>

    <help>
<![CDATA[
**BCFTools View**

VCF/BCF conversion, view, subset and filter VCF/BCF files.


**Input format**

`BCF files <http://www.1000genomes.org/wiki/analysis/variant-call-format/bcf-binary-vcf-version-2/>`_

------

**Outputs**

VCF or BCF files

]]>
    </help>
    <expand macro="citations"/>
</tool>
