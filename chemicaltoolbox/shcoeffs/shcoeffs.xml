<tool id="shcoeffs" name="Calculate 3D ligand descriptor" version="0.1.0">
    <description>based on spherical harmonics</description>
    <requirements>
        <container type="docker">sb17/shcoeffs:latest</container>
    </requirements>
    <command detect_errors="exit_code">
        <![CDATA[
            ln -s $ligand ligand.pdb &&
	    python -m esp_dnn.predict -m ligand -i . -o . &&
	    esp-surface-generator ligand.pdb.pqr ligand.pdb.tmesh &&
 	    sh-coeff-calculator . &&
	    cp rid_coeffs.csv $output
        ]]>
    </command>

    <inputs>
        <param name="ligand" type="data" format="pdb" label="Ligand file" />
    </inputs>

    <outputs>
        <data name="output" format="csv" label="Spherical harmonics coefficients" />
    </outputs>
    <tests>
        <test>
            <param name="ligand" value="ligand.pdb"/>
            <output name="output" value="shcoeffs.csv"/>
        </test>
    </tests>
    <help>
<![CDATA[

.. class:: infomark

**What this tool does**

Generate 3D descriptors for a ligand conformer, based on predicting the electrostatic potential (ESP) using a deep neural network, and computing spherical harmonic coefficients.
]]>
    </help>
    <citations>
        <citation type="doi">10.1021/acs.jmedchem.9b01129</citation>
    </citations>
</tool>
