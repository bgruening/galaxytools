<tool id="high-throughput_sequencing_metadata" name="High-Throughput Sequencing Metadata" version="2.1">
    <description>High-throughput sequencing metadata template</description>
    <requirements>
    </requirements>
    <command detect_errors="aggressive" interpreter="python">
<![CDATA[
        high-throughput_sequencing_metadata_template.py
        --title '$series.title'
        --summary '$series.summary'
        --overall_design '$series.overall_design'
        #for $i in $series.contributors
            --contributor '$i.contributor'
        #end for

        #if str($supplementary_file) != ''
            --supplementary_file '$series.supplementary_file'
        #end if
        #if str($series.sra_center_name_code) != ''
            --sra_center_name_code '$series.sra_center_name_code'
        #end if



        #if str($protocols.growth_protocol) != ''
            --growth_protocol '$protocols.growth_protocol'
        #end if
        #if str($protocols.treatment_protocol) != ''
            --treatment_protocol '$protocols.treatment_protocol'
        #end if
        #if str($protocols.extract_protocol) != ''
            --extract_protocol '$protocols.extract_protocol'
        #end if
        #if str($protocols.library_construction_protocol) != ''
            --library_construction_protocol '$protocols.library_construction_protocol'
        #end if
        #if str($protocols.library_strategy) != ''
            --library_strategy '$protocols.library_strategy'
        #end if



        #for $i in $data_processing_pipeline.data_processing_steps
            --data_processing_step '$i.data_processing_step'
        #end for

        #if str($data_processing_pipeline.genome_build) != ''
            --genome_build '$data_processing_pipeline.genome_build'
        #end if
        #if str($data_processing_pipeline.processed_data_files_format_content) != ''
            --processed_data_files_format_content '$data_processing_pipeline.processed_data_files_format_content'
        #end if

        #for $i in $processed_data_files
            --processed_file '$i.processed_data_file'
            --processed_file_name '$i.processed_data_file.name'
        #end for

        #for $i in $raw_files
            --raw_file '$i.raw_file'
            --raw_file_name '$i.raw_file.name'
            --raw_file_instrument_model '$i.instrument_model'
            --raw_file_read_length '$i.read_length'
            --raw_file_single_paired_choice '$i.single_paired'
        #end for


        #for $i in $samples
            --sample_name '$i.sample_name'
            --sample_title '$i.title'
            --sample_source_name '$i.source_name'
            --sample_organism '$i.organism'
            --sample_cell_type '$i.cell_type'
            --sample_strain '$i.strain'
            --sample_chip '$i.chip'
            --sample_molecule '$i.molecule'
            --sample_description '$i.description'
            
            #set $files_list = ''
            #set $sep = ''
            #for $file in $i.processed_input_files
                #set $files_list += $sep + str($file.processed_data_file.name)
                #set $sep = ';'
            #end for
            --sample_processed_input_files '$files_list'

            #set $files_list = ''
            #set $sep = ''
            #for $file in $i.raw_input_files
                #set $files_list += $sep + str($file.raw_file.name)
                #set $sep = ';'
            #end for
            --sample_raw_input_files '$files_list'

        #end for

        #for $i in $paired_experiments
            --paired_file_name1 '$i.file_name1.name'
            --paired_file_name2 '$i.file_name2.name'
            --paired_file_name3 '$i.file_name3.name'
            --paired_file_name4 '$i.file_name4.name'
            --paired_avg '$i.avg_insert_size'
            --paired_std '$i.standard_deviation'
        #end for

        --output '$out_file'
]]>
    </command>
    <inputs>
        <section name="series" title="Series" expanded="True">
            <param name="title" label="Title" type="text" help="The title for the sequence"/>
            <param name="summary" label="Summary" type="text" help="The summary for the sequence"/>
            <param name="overall_design" label="Overall Design" type="text" help="The overall design for the sequence"/>
            <repeat name="contributors" title="Contributor">
                <param name="contributor" label="Contributor" type="text" optional="true" help="A contributor for the sequence"/>
            </repeat>
            <param type="data" name="supplementary_file" label="Supplementary File" format="data" optional="true" help="Supplementary file"/>
            <param name="sra_center_name_code" label="SRA Name Code" type="text" optional="true" help="The overall design for the sequence"/>
        </section>

        <repeat name="processed_data_files" title="Processed Data Files">
            <param name="processed_data_file" type="data" format="data" label="Processed Input File"/>
        </repeat>

        <repeat name="raw_files" title="Raw Files">
            <param name="raw_file" type="data" format="data" label="Raw Input File"/>
            <param name="instrument_model" type="text" label="instrument model"/>
            <param name="read_length" type="text" label="read length"/>
            <param name="single_paired" type="text" label="single or paired-end"/>
        </repeat>

        <repeat name="samples" title="Samples">
            <param name="sample_name" label="Sample name" type="text" optional="true" help="1st contributor for the sequence"/>
            <param name="title" label="Title" type="text" optional="true" help="1st contributor for the sequence"/>
            <param name="source_name" label="Source Name" type="text" optional="true" help="1st contributor for the sequence"/>
            <param name="organism" label="Organism" type="text" optional="true" help="1st contributor for the sequence"/>
            <param name="cell_type" label="Characteristics: cell type" type="text" optional="true" help="1st contributor for the sequence"/>
            <param name="strain" label="Characteristics: strain" type="text" optional="true" help="1st contributor for the sequence"/>
            <param name="chip" label="Characteristics: ChIP" type="text" optional="true" help="1st contributor for the sequence"/>
            <param name="molecule" label="Molecule" type="text" optional="true" help="1st contributor for the sequence"/>
            <param name="description" label="Description" type="text" optional="true" help="1st contributor for the sequence"/>
            <repeat name="processed_input_files" title="Processed Data Files">
                <param name="processed_data_file" type="data" format="data" label="Processed Input File"/>
            </repeat>
            <repeat name="raw_input_files" title="Raw Files">
                <param name="raw_file" type="data" format="data" label="Raw Input File"/>
            </repeat>
        </repeat>
        <section name="protocols" title="Protocols" expanded="False">
            <param name="growth_protocol" label="Growth Protocol" type="text" optional="true" help=""/>
            <param name="treatment_protocol" label="Treatment Protocol" type="text" optional="true" help=""/>
            <param name="extract_protocol" label="Extract Protocol" type="text" optional="true" help=""/>
            <param name="library_construction_protocol" label="Library Construction Protocol" type="text" optional="true" help=""/>
            <param name="library_strategy" label="Library Strategy" type="text" optional="true" help=""/>
        </section>
        <section name="data_processing_pipeline" title="Data Processing Pipeline" expanded="False">
            <repeat name="data_processing_steps" title="Data Processing Step">
                <param name="data_processing_step" label="Data Processing Step" type="text" optional="true" help="Description for each step in the pipeline"/>
            </repeat>
            <param name="genome_build" label="genome build" type="text" optional="true" help=""/>
            <param name="processed_data_files_format_content" label="Processed Data Files Format and Content" type="text" optional="true" help=""/>
        </section>
        <repeat name="paired_experiments" title="PAIRED-END Experiments" help="For paired-end experiments, list the 2 associated raw files, and provide average insert size and standard deviation, if known. For SOLiD experiments, list the 4 file names">
            <param name="file_name1" type="data" format="data" optional="true" label="File Name 1" help=""/>
            <param name="file_name2" type="data" format="data" optional="true" label="File Name 2" help=""/>
            <param name="file_name3" type="data" format="data" optional="true" label="File Name 3" help=""/>
            <param name="file_name4" type="data" format="data" optional="true" label="File Name 4" help=""/>
            <param name="avg_insert_size" label="average insert size" type="float" optional="true" help=""/>
            <param name="standard_deviation" label="standard deviation" type="float" optional="true" help=""/>
        </repeat>
    </inputs>
    <outputs>
        <data format="tsv" name="out_file" label="Output file."/>
    </outputs>
    <tests>
        <test>
            <section name="series">
                <param name="title" value="test title"/>
                <param name="summary" value="test summary"/>
                <param name="overall_design" value="the desing of the sequence"/>
                <repeat name="contributors">
                    <param name="contributor" value="Hassan"/>
                </repeat>
                <repeat name="contributors">
                    <param name="contributor" value="Amr"/>
                </repeat>
                <param name="sra_center_name_code" value="12345"/>
            </section>

            <repeat name="processed_data_files">
                <param name="processed_data_file" value="tRNA_2.epms"/>
            </repeat>

            <repeat name="processed_data_files">
                <param name="processed_data_file" value="haca.snoRNA_anchor.bed"/>
            </repeat>

            <repeat name="raw_files">
                <param name="raw_file" value="archaea.fa"/>
                <param name="instrument_model" value="Inst 1"/>
                <param name="read_length" value="10"/>
                <param name="single_paired" value="paired-end"/>
            </repeat>

            <repeat name="raw_files">
                <param name="raw_file" value="archaea-ref.aln"/>
                <param name="instrument_model" value="Inst 2"/>
                <param name="read_length" value="20"/>
                <param name="single_paired" value="paired-end"/>
            </repeat>

            <repeat name="samples">
                <param name="sample_name" value="sample 1"/>
                <param name="title" value="sample title"/>
                <param name="source_name" value="sample source"/>
                <param name="organism" value="sample organism"/>
                <param name="cell_type" value="sample cell type"/>
                <param name="strain" value="sample strain"/>
                <param name="chip" value="sample chip"/>
                <param name="molecule" value="mole"/>
                <param name="description" value="desc"/>
                <repeat name="processed_input_files">
                    <param name="processed_data_file" value="tRNA_2.epms"/>
                </repeat>
                <repeat name="processed_input_files">
                    <param name="processed_data_file" value="haca.snoRNA_anchor.bed"/>
                </repeat>
                <repeat name="raw_input_files">
                    <param name="raw_file" value="archaea-ref.aln"/>
                </repeat>
                <repeat name="raw_input_files">
                    <param name="raw_file" value="archaea.fa"/>
                </repeat>
            </repeat>
            <section name="protocols">
                <param name="growth_protocol" value="growth"/>
                <param name="treatment_protocol" value="treatment"/>
                <param name="extract_protocol" value="extract"/>
                <param name="library_construction_protocol" value="Lib C"/>
                <param name="library_strategy" value="Lib S"/>
            </section>
            <section name="data_processing_pipeline">
                <repeat name="data_processing_steps">
                    <param name="data_processing_step" value="1st step"/>
                </repeat>
                <repeat name="data_processing_steps">
                    <param name="data_processing_step" value="2nd step"/>
                </repeat>
                <repeat name="data_processing_steps">
                    <param name="data_processing_step" value="3rd step"/>
                </repeat>
                <repeat name="data_processing_steps">
                    <param name="data_processing_step" value="4th step"/>
                </repeat>
                <param name="genome_build" value="built"/>
                <param name="processed_data_files_format_content" value="processed"/>
            </section>
            <repeat name="paired_experiments">
                <param name="file_name1" value="archaea.fa"/>
                <param name="file_name2" value="archaea-ref.aln"/>
                <param name="avg_insert_size" value="23"/>
                <param name="standard_deviation" value="41"/>
            </repeat>
            <output name="out_file" file="Output_file.tsv"/>
        </test>
    </tests>

    <help>
<![CDATA[

High-throughput sequencing metadata template (version 2.1).
All fields in this template must be completed.
Templates containing example data are found in the METADATA EXAMPLES spreadsheet tabs at the foot of this page.
Field names (in blue on this page) should not be edited. Hover over cells containing field names to view field content guidelines.
Human data. If there are patient privacy concerns regarding making data fully public through GEO, please submit to NCBI's dbGaP (http://www.ncbi.nlm.nih.gov/gap/) database. dbGaP has controlled access mechanisms and is an appropriate resource for hosting sensitive patient data.

-----

**Sections**

- SERIES
    This section describes the overall experiment.


- SAMPLES
    This section lists and describes each of the biological Samples under investgation, as well as any protocols that are specific to individual Samples.
    Additional "processed data file" or "raw file" columns may be included.


- PROTOCOLS
    Any of the protocols below which are applicable to only a subset of Samples should be included as additional columns of the SAMPLES section instead.                                                        


- DATA PROCESSING PIPELINE
    Data processing steps include base-calling, alignment, filtering, peak-calling, generation of normalized abundance measurements etc…
    For each step provide a description, as well as software name, version, parameters, if applicable.
    Include additional steps, as necessary.


- PROCESSED DATA FILES
    For each file listed in the "processed data file" columns of the SAMPLES section, provide additional information below.


- RAW FILES
    For each file listed in the "raw file" columns of the SAMPLES section, provide additional information below.


- PAIRED-END EXPERIMENTS
    For paired-end experiments, list the 2 associated raw files, and provide average insert size and standard deviation, if known. For SOLiD experiments, list the 4 file names (include "file name 3" and "file name 4" columns).

]]>
    </help>
    <citations>
    </citations>
</tool>
