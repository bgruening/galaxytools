<tool id="itsx" name="ITSx" version="@TOOL_VERSION@+galaxy@SUFFIX_VERSION@" profile="20.01">
    <description>identifies ITS sequences and extracts the ITS region</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <xrefs>
        <xref type="bio.tools">ITSx</xref>
    </xrefs>
    <expand macro="requirements" />
    <version_command>flye --version</version_command>
    <command detect_errors="exit_code"><![CDATA[
    
    -i '$i'
    --save_regions $save_regions
    $only_output
    --partial $partial
    --minlen $minlen
    $truncate
    -t $sequence_section.character_code
    -E $sequence_section.E
    -S $sequence_section.S
    -N $sequence_section.N
    --selection_priority $sequence_section.selection_priority
    --allow_single_domain $sequence_section.allow_single_domain
    $sequence_section.allow_reorder
    $sequence_section.complement
    #if 'summay' in $output_options.output_files
        --summary T
    #else
        --summary F
    #end if
    #if 'graphical' in $output_options.output_files
        --graphical T
    #else
        --graphical F
    #end if
    #if 'fasta' in $output_options.output_files
        --fasta T
    #else
        --fasta F
    #end if
    #if 'concat' in $output_options.output_files
        --concat T
    #else
        --concat F
    #end if
    #if 'table' in $output_options.output_files
        --table T
    #else
        --table F
    #end if
    #if 'not_found' in $output_options.output_files
        --not_found T
    #else
        --not_found F
    #end if
    #if 'detailed_results' in $output_options.output_files
        --detailed_results T
    #else
        --detailed_results F
    #end if
    $output_options.preserve
    
    ## Outputs
    ]]></command>
    <inputs>
        <param argument="-i" type="data" format="fasta" label="FASTA file"/>
        <section name="sequence_section" title="Sequence selection options">
            <param name="character_code" argument="-t" type="select" display="checkboxes"
                multiple="true" label="Profile set to use for the search"
                help="Can be used to restrict the search to only a few organism groups types to save time, if 
                    one or more of the origins are not relevant to the dataset under study. Default: all">
                <option value="all">All</option>
                <option value="a">Alveolata</option>
                <option value="b">Bryophyta</option>
                <option value="c">Bacillariophyta</option>
                <option value="d">Amoebozoa</option>
                <option value="e">Euglenozoa</option>
                <option value="f">Fungi</option>
                <option value="g">Chlorophyta</option>
                <option value="h">Rhodophyta</option>
                <option value="i">Phaeophyceae</option>
                <option value="l">Marchantiophyta</option>
                <option value="m">Metazoa</option>
                <option value="o">Oomycota</option>
                <option value="p">Haptophyceae</option>
                <option value="q">Raphidophyceae</option>
                <option value="r">Rhizaria</option>
                <option value="s">Synurophyceae</option>
                <option value="t">Tracheophyta</option>
                <option value="u">Eustigmatophyceae</option>
                <option value="x">Apusozoa</option>
                <option value="y">Parabasalia</option>
            </param>
            <param argument="-E" type="float" min="0" max="1" value="0.00005" label="Domain E-value cutoff" 
                help="Domain E-value cutoff for a sequence to be included in the output. Default: 1e-5"/>
            <param argument="-S" type="float" min="0" max="1" value="0" label="Domain score cutoff" 
                help="Domain score cutoff for a sequence to be included in the output. Default:0" />
            <param argument="-N" type="integer" min="0" max="20" value="2" label="Minimal number of domains" 
                help="The minimal number of domains that must match a sequence before it is included. Default:2" />
            <param argument="--selection_priority" type="select" label="Selection priority" help="Selects what will 
                be of highest priority when determining the origin of the sequence. Default:score">
                <option value="score">Score</option>
                <option value="sum">Sum</option>
                <option value="domains">Domains</option>
                <option value="eval">Eval</option>
            </param>
            <conditional name="cutoff_conditional">
                <param name="cutoff_mode" type="select" label="HMMER search cutoff mode" help="Default: Score cutoff">
                    <option value="eval">E-value cutoff</option>
                    <option value="score" selected="true">Score cutoff</option>
                </param>
                <when value="eval">
                    <param argument="--search_eval" type="float" min="0" max="1" value="" label="E-value cutoff used in the HMMER search" 
                        help="High numbers may slow down the process" />
                </when>
                <when value="score">
                    <param argument="--search_score" type="float" min="0" max="1" value="" label="The score cutoff used in the HMMER search"
                        help="Low numbers may slow down the process" />
                </when>
            </conditional>
            <param argument="--allow_single_domain" type="float" min="0" max="1" value="0" label="Allow single domain" 
                help="Allow inclusion of sequences that only find a single domain, given that they meet the given E-value and score thresholds. Default: 0" />
            <param argument="--allow_reorder" type="boolean" truevalue="T" falsevalue="F" checked="false" label="Allow reorder" 
                help="Allows profiles to be in the wrong order on extracted sequences" />
            <param argument="--complement" type="boolean" truevalue="T" falsevalue="F" checked="true" label="Check both DNA strains" 
                help="Checks both DNA strands against the database, creating reverse complements" />
        </section>
        <section name="output_options" title="Output options">
            <param name="output_files" type="select" multiple="true" display="checkboxes" label="Output files">
                <option value="summary" selected="true">Summary</option>
                <option value="graphical" selected="true">Graphical output</option>
                <option value="fasta" selected="true">FASTA-format of extracted ITS sequences</option>
                <option value="concat">Concateneted ITS sequences</option>
                <option value="table" selected="true">Table of sequences containing the positions IT sequences</option>
                <option value="not_found" selected="true">List of not-found entries</option>
                <option value="detailed_results">Table of all results</option>
            </param>
            <param argument="--preserve" type="boolean" truevalue="T" falsevalue="F" checked="false" label="Preserve sequence headers in input file" help="Preserve sequence headers in input file instead of printing out ITSx headers. Default: No" />
        </section>
        <param argument="--save_regions" type="select" label="Save regions" help="A comma separated list of regions to output separate FASTA files">
            <option value="none">None</option>
            <option value="SSU">SSU</option>
            <option value="ITS1" selected="true">TODO: </option>
            <option value="ITS2" selected="true">TODO: </option>
            <option value="5.8S">5.8S</option>
            <option value="LSU">LSU</option>
            <option value="all">All</option>
        </param>
        <param argument="--only_output" type="boolean" truevalue="T" falsevalue="F" checked="false" label="Only full-lenght regions" help="If enabled, output is limited to full-length regions. Default: no" />
        <param argument="--partial" type="integer" min="0" value="0" label="Saves additional FASTA-files for full and partial ITS sequences longer than the specified cutoff" help="Default: 0 (disabled)" />
        <param argument="--minlen" type="integer" min="0" value="0" label="Minimum length the ITS regions must be to be outputted in the concatenated file" help="Default: 0" />
        <param argument="--truncate" type="boolean" truevalue="T" falsevalue="F" checked="false" label="Truncates the FASTA output to only contain the actual ITS sequences found" help="Default: yes" />
    </inputs>
    <outputs>
    </outputs>
    <tests>
 
    </tests>
    <help><![CDATA[

.. class:: infomark

**Purpose**

Hello, world!

  ]]></help>
    <expand macro="citations" />
</tool>
