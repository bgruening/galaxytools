<tool id="uniprot" name="UniProt" version="0.8" profile="24.1">
    <description>ID mapping and retrieval</description>
    <macros>
        <xml name="fields">
            <param name="fields" type="select" multiple="true" optional="false" label="Fields" help="Will be ignored for non Uniprot targets">
                <option value="accession" selected="true">Names &amp; Taxonomy: Entry </option>
                <option value="id" selected="true">Names &amp; Taxonomy: Entry Name </option>
                <option value="gene_names" selected="true">Names &amp; Taxonomy: Gene Names </option>
                <option value="gene_primary">Names &amp; Taxonomy: Gene Names (primary) </option>
                <option value="gene_synonym">Names &amp; Taxonomy: Gene Names (synonym) </option>
                <option value="gene_oln">Names &amp; Taxonomy: Gene Names (ordered locus) </option>
                <option value="gene_orf">Names &amp; Taxonomy: Gene Names (ORF) </option>
                <option value="organism_name" selected="true">Names &amp; Taxonomy: Organism </option>
                <option value="organism_id">Names &amp; Taxonomy: Organism ID </option>
                <option value="protein_name" selected="true">Names &amp; Taxonomy: Protein names </option>
                <option value="xref_proteomes">Names &amp; Taxonomy: Proteomes </option>
                <option value="lineage">Names &amp; Taxonomy: Taxonomic lineage </option>
                <option value="lineage_ids">Names &amp; Taxonomy: Taxonomic lineage (IDs) </option>
                <option value="virus_hosts">Names &amp; Taxonomy: Virus hosts </option>
                <option value="cc_alternative_products">Sequences: Alternative products </option>
                <option value="ft_var_seq">Sequences: Alternative sequence </option>
                <option value="cc_sc_epred">Sequences: Erroneous gene model prediction </option>
                <option value="fragment">Sequences: Fragment </option>
                <option value="encoded_in">Sequences: Gene encoded in </option>
                <option value="length" selected="true">Sequences: Length </option>
                <option value="mass">Sequences: Mass </option>
                <option value="cc_mass_spectrometry">Sequences: Mass spectrometry </option>
                <option value="ft_variant">Sequences: Natural variant </option>
                <option value="ft_non_cons">Sequences: Non-adjacent residues </option>
                <option value="ft_non_std">Sequences: Non-standard residue </option>
                <option value="ft_non_ter">Sequences: Non-terminal residue </option>
                <option value="cc_polymorphism">Sequences: Polymorphism </option>
                <option value="cc_rna_editing">Sequences: RNA editing </option>
                <option value="sequence">Sequences: Sequence </option>
                <option value="cc_sequence_caution">Sequences: Sequence caution </option>
                <option value="ft_conflict">Sequences: Sequence conflict </option>
                <option value="ft_unsure">Sequences: Sequence uncertainty </option>
                <option value="sequence_version">Sequences: Sequence version </option>
                <option value="absorption">Function: Absorption </option>
                <option value="ft_act_site">Function: Active site </option>
                <option value="cc_activity_regulation">Function: Activity regulation </option>
                <option value="ft_binding">Function: Binding site </option>
                <option value="cc_catalytic_activity">Function: Catalytic activity </option>
                <option value="cc_cofactor">Function: Cofactor </option>
                <option value="ft_dna_bind">Function: DNA binding </option>
                <option value="ec">Function: EC number </option>
                <option value="cc_function">Function: Function [CC] </option>
                <option value="kinetics">Function: Kinetics </option>
                <option value="cc_pathway">Function: Pathway </option>
                <option value="ph_dependence">Function: pH dependence </option>
                <option value="redox_potential">Function: Redox potential </option>
                <option value="rhea">Function: Rhea ID </option>
                <option value="ft_site">Function: Site </option>
                <option value="temp_dependence">Function: Temperature dependence </option>
                <option value="annotation_score">Miscellaneous: Annotation </option>
                <option value="cc_caution">Miscellaneous: Caution </option>
                <option value="comment_count">Miscellaneous: Comment Count </option>
                <option value="feature_count">Miscellaneous: Features </option>
                <option value="keywordid">Miscellaneous: Keyword ID </option>
                <option value="keyword">Miscellaneous: Keywords </option>
                <option value="cc_miscellaneous">Miscellaneous: Miscellaneous [CC] </option>
                <option value="protein_existence">Miscellaneous: Protein existence </option>
                <option value="reviewed" selected="true">Miscellaneous: Reviewed </option>
                <option value="tools">Miscellaneous: Tools </option>
                <option value="uniparc_id">Miscellaneous: UniParc </option>
                <option value="cc_interaction">Interaction: Interacts with </option>
                <option value="cc_subunit">Interaction: Subunit structure [CC] </option>
                <option value="cc_developmental_stage">Expression: Developmental stage </option>
                <option value="cc_induction">Expression: Induction </option>
                <option value="cc_tissue_specificity">Expression: Tissue specificity </option>
                <option value="go_p">Gene Ontology: (biological process) </option>
                <option value="go_c">Gene Ontology: (cellular component) </option>
                <option value="go">Gene Ontology: (GO) </option>
                <option value="go_f">Gene Ontology: (molecular function) </option>
                <option value="go_id">Gene Ontology: IDs </option>
                <option value="cc_allergen">Pathology &amp; Biotech Allergenic properties </option>
                <option value="cc_biotechnology">Pathology &amp; Biotech: Biotechnological use </option>
                <option value="cc_disruption_phenotype">Pathology &amp; Biotech: Disruption phenotype </option>
                <option value="cc_disease">Pathology &amp; Biotech: Involvement in disease </option>
                <option value="ft_mutagen">Pathology &amp; Biotech: Mutagenesis </option>
                <option value="cc_pharmaceutical">Pathology &amp; Biotech: Pharmaceutical use </option>
                <option value="cc_toxic_dose">Pathology &amp; Biotech: Toxic dose </option>
                <option value="ft_intramem">Subcellular location: Intramembrane </option>
                <option value="cc_subcellular_location">Subcellular location: Subcellular location [CC] </option>
                <option value="ft_topo_dom">Subcellular location: Topological domain </option>
                <option value="ft_transmem">Subcellular location: Transmembrane </option>
                <option value="ft_chain">PTM / Processsing: Chain </option>
                <option value="ft_crosslnk">PTM / Processsing: Cross-link </option>
                <option value="ft_disulfid">PTM / Processsing: Disulfide bond </option>
                <option value="ft_carbohyd">PTM / Processsing: Glycosylation </option>
                <option value="ft_init_met">PTM / Processsing: Initiator methionine </option>
                <option value="ft_lipid">PTM / Processsing: Lipidation </option>
                <option value="ft_mod_res">PTM / Processsing: Modified residue </option>
                <option value="ft_peptide">PTM / Processsing: Peptide </option>
                <option value="cc_ptm">PTM / Processsing: Post-translational modification </option>
                <option value="ft_propep">PTM / Processsing: Propeptide </option>
                <option value="ft_signal">PTM / Processsing: Signal peptide </option>
                <option value="ft_transit">PTM / Processsing: Transit peptide </option>
                <option value="structure_3d">Structure: 3D </option>
                <option value="ft_strand">Structure: Beta strand </option>
                <option value="ft_helix">Structure: Helix </option>
                <option value="ft_turn">Structure: Turn </option>
                <option value="lit_pubmed_id">Publications: PubMed ID </option>
                <option value="date_created">Date of creation </option>
                <option value="date_modified">Date of last modification </option>
                <option value="date_sequence_modified">Date of last sequence modification </option>
                <option value="version">Entry version </option>
                <option value="ft_coiled">Family &amp; Domains: Coiled coil </option>
                <option value="ft_compbias">Family &amp; Domains: Compositional bias </option>
                <option value="cc_domain">Family &amp; Domains: Domain[CC] </option>
                <option value="ft_domain">Family &amp; Domains: Domain[FT] </option>
                <option value="ft_motif">Family &amp; Domains: Motif </option>
                <option value="protein_families">Family &amp; Domains: Protein families </option>
                <option value="ft_region">Family &amp; Domains: Region </option>
                <option value="ft_repeat">Family &amp; Domains: Repeat </option>        
                <option value="ft_zn_fing">Family &amp; Domains: Zinc finger </option>
            </param>
        </xml>

        <xml name="uniprot_targets">
            <param name="to" type="select" label="Target database:">
                <option value="UniProtKB">UniProt - UniProtKB</option>
                <option value="UniProtKB-Swiss-Prot">UniProt - UniProtKB/Swiss-Prot</option>
                <yield/>
            </param>
        </xml>
    </macros>
    <requirements>
        <requirement type="package" version="2.25.1">requests</requirement>
    </requirements>
    <version_command>echo "UniProt ID mapping for Galaxy in version 0.1"</version_command>
    <command detect_errors="aggressive"><![CDATA[
        cut -f ${id_column} '$infile' > id_file.tabular &&

        python '$__tool_directory__/uniprot.py'
        #if $tool.tool_choice == "retrieve":
            retrieve -f $tool.format id_file.tabular ./output
        #elif $tool.tool_choice == "map":
            map
            --format tsv
            #if $tool.fields
                --fields #echo ",".join($tool.fields)
            #end if
            "$tool.from_cond.from"
            "$tool.from_cond.to"
            id_file.tabular
            ./output
        #end if
    ]]></command>
    <inputs>
        <param name="infile" type="data" format="tabular" label="Input file with IDs"
            help="One ID in each line."/>
        <param name="id_column" label="ID column" type="data_column" data_ref="infile" help=""/>
        <conditional name="tool">
            <param name="tool_choice" type="select" label="Do you want to map IDs or retrieve data from UniProt" help="">
                <option value="retrieve">Retrieve: request entries by uniprot accession using batch retrieval</option>
                <option value="map" selected="True">Map: map a list of ids from one format onto another using uniprots mapping API</option>
            </param>
            <when value="map">
                <!-- conditional auto generated with python tools/uniprot_rest_interface/uniprot.py menu -->
                <conditional name="from_cond">
                    <param name="from" type="select" label="Source database:">
                        <option value="UniProtKB_AC-ID">UniProt - UniProtKB AC/ID</option>
                        <option value="UniParc">UniProt - UniParc</option>
                        <option value="UniRef50">UniProt - UniRef50</option>
                        <option value="UniRef90">UniProt - UniRef90</option>
                        <option value="UniRef100">UniProt - UniRef100</option>
                        <option value="Gene_Name">UniProt - Gene Name</option>
                        <option value="CRC64">UniProt - CRC64</option>
                        <option value="CCDS">Sequence DBs - CCDS</option>
                        <option value="EMBL-GenBank-DDBJ">Sequence DBs - EMBL/GenBank/DDBJ</option>
                        <option value="EMBL-GenBank-DDBJ_CDS">Sequence DBs - EMBL/GenBank/DDBJ CDS</option>
                        <option value="GI_number">Sequence DBs - GI number</option>
                        <option value="PIR">Sequence DBs - PIR</option>
                        <option value="RefSeq_Nucleotide">Sequence DBs - RefSeq Nucleotide</option>
                        <option value="RefSeq_Protein">Sequence DBs - RefSeq Protein</option>
                        <option value="PDB">3D structure DBs - PDB</option>
                        <option value="BioGRID">Protein-protein interaction DBs - BioGRID</option>
                        <option value="ComplexPortal">Protein-protein interaction DBs - ComplexPortal</option>
                        <option value="DIP">Protein-protein interaction DBs - DIP</option>
                        <option value="STRING">Protein-protein interaction DBs - STRING</option>
                        <option value="ChEMBL">Chemistry - ChEMBL</option>
                        <option value="DrugBank">Chemistry - DrugBank</option>
                        <option value="GuidetoPHARMACOLOGY">Chemistry - GuidetoPHARMACOLOGY</option>
                        <option value="SwissLipids">Chemistry - SwissLipids</option>
                        <option value="Allergome">Protein family/group DBs - Allergome</option>
                        <option value="CLAE">Protein family/group DBs - CLAE</option>
                        <option value="ESTHER">Protein family/group DBs - ESTHER</option>
                        <option value="MEROPS">Protein family/group DBs - MEROPS</option>
                        <option value="PeroxiBase">Protein family/group DBs - PeroxiBase</option>
                        <option value="REBASE">Protein family/group DBs - REBASE</option>
                        <option value="TCDB">Protein family/group DBs - TCDB</option>
                        <option value="GlyConnect">PTM DBs - GlyConnect</option>
                        <option value="BioMuta">Genetic variation DBs - BioMuta</option>
                        <option value="DMDM">Genetic variation DBs - DMDM</option>
                        <option value="World-2DPAGE">2D gel DBs - World-2DPAGE</option>
                        <option value="CPTAC">Proteomic DBs - CPTAC</option>
                        <option value="ProteomicsDB">Proteomic DBs - ProteomicsDB</option>
                        <option value="DNASU">Protocols and materials DBs - DNASU</option>
                        <option value="Ensembl">Genome annotation DBs - Ensembl</option>
                        <option value="Ensembl_Genomes">Genome annotation DBs - Ensembl Genomes</option>
                        <option value="Ensembl_Genomes_Protein">Genome annotation DBs - Ensembl Genomes Protein</option>
                        <option value="Ensembl_Genomes_Transcript">Genome annotation DBs - Ensembl Genomes Transcript</option>
                        <option value="Ensembl_Protein">Genome annotation DBs - Ensembl Protein</option>
                        <option value="Ensembl_Transcript">Genome annotation DBs - Ensembl Transcript</option>
                        <option value="GeneID">Genome annotation DBs - GeneID</option>
                        <option value="KEGG">Genome annotation DBs - KEGG</option>
                        <option value="PATRIC">Genome annotation DBs - PATRIC</option>
                        <option value="UCSC">Genome annotation DBs - UCSC</option>
                        <option value="WBParaSite">Genome annotation DBs - WBParaSite</option>
                        <option value="WBParaSite_Transcript-Protein">Genome annotation DBs - WBParaSite Transcript/Protein</option>
                        <option value="ArachnoServer">Organism-specific DBs - ArachnoServer</option>
                        <option value="Araport">Organism-specific DBs - Araport</option>
                        <option value="CGD">Organism-specific DBs - CGD</option>
                        <option value="ConoServer">Organism-specific DBs - ConoServer</option>
                        <option value="dictyBase">Organism-specific DBs - dictyBase</option>
                        <option value="EchoBASE">Organism-specific DBs - EchoBASE</option>
                        <option value="euHCVdb">Organism-specific DBs - euHCVdb</option>
                        <option value="FlyBase">Organism-specific DBs - FlyBase</option>
                        <option value="GeneCards">Organism-specific DBs - GeneCards</option>
                        <option value="GeneReviews">Organism-specific DBs - GeneReviews</option>
                        <option value="HGNC">Organism-specific DBs - HGNC</option>
                        <option value="LegioList">Organism-specific DBs - LegioList</option>
                        <option value="Leproma">Organism-specific DBs - Leproma</option>
                        <option value="MaizeGDB">Organism-specific DBs - MaizeGDB</option>
                        <option value="MGI">Organism-specific DBs - MGI</option>
                        <option value="MIM">Organism-specific DBs - MIM</option>
                        <option value="neXtProt">Organism-specific DBs - neXtProt</option>
                        <option value="OpenTargets">Organism-specific DBs - OpenTargets</option>
                        <option value="Orphanet">Organism-specific DBs - Orphanet</option>
                        <option value="PharmGKB">Organism-specific DBs - PharmGKB</option>
                        <option value="PomBase">Organism-specific DBs - PomBase</option>
                        <option value="PseudoCAP">Organism-specific DBs - PseudoCAP</option>
                        <option value="RGD">Organism-specific DBs - RGD</option>
                        <option value="SGD">Organism-specific DBs - SGD</option>
                        <option value="TubercuList">Organism-specific DBs - TubercuList</option>
                        <option value="VEuPathDB">Organism-specific DBs - VEuPathDB</option>
                        <option value="VGNC">Organism-specific DBs - VGNC</option>
                        <option value="WormBase">Organism-specific DBs - WormBase</option>
                        <option value="WormBase_Protein">Organism-specific DBs - WormBase Protein</option>
                        <option value="WormBase_Transcript">Organism-specific DBs - WormBase Transcript</option>
                        <option value="Xenbase">Organism-specific DBs - Xenbase</option>
                        <option value="ZFIN">Organism-specific DBs - ZFIN</option>
                        <option value="eggNOG">Phylogenomic DBs - eggNOG</option>
                        <option value="GeneTree">Phylogenomic DBs - GeneTree</option>
                        <option value="HOGENOM">Phylogenomic DBs - HOGENOM</option>
                        <option value="OMA">Phylogenomic DBs - OMA</option>
                        <option value="OrthoDB">Phylogenomic DBs - OrthoDB</option>
                        <option value="TreeFam">Phylogenomic DBs - TreeFam</option>
                        <option value="BioCyc">Enzyme and pathway DBs - BioCyc</option>
                        <option value="PlantReactome">Enzyme and pathway DBs - PlantReactome</option>
                        <option value="Reactome">Enzyme and pathway DBs - Reactome</option>
                        <option value="UniPathway">Enzyme and pathway DBs - UniPathway</option>
                        <option value="ChiTaRS">Miscellaneous - ChiTaRS</option>
                        <option value="GeneWiki">Miscellaneous - GeneWiki</option>
                        <option value="GenomeRNAi">Miscellaneous - GenomeRNAi</option>
                        <option value="PHI-base">Miscellaneous - PHI-base</option>
                        <option value="CollecTF">Gene expression DBs - CollecTF</option>
                        <option value="DisProt">Family and domain DBs - DisProt</option>
                        <option value="IDEAL">Family and domain DBs - IDEAL</option>
                    </param>
                    <when value="UniProtKB_AC-ID">
                        <param name="to" type="select" label="Target database:">
                            <option value="CCDS">Sequence DBs - CCDS</option>
                            <option value="PIR">Sequence DBs - PIR</option>
                            <option value="PDB">3D structure DBs - PDB</option>
                            <option value="BioGRID">Protein-protein interaction DBs - BioGRID</option>
                            <option value="ComplexPortal">Protein-protein interaction DBs - ComplexPortal</option>
                            <option value="DIP">Protein-protein interaction DBs - DIP</option>
                            <option value="STRING">Protein-protein interaction DBs - STRING</option>
                            <option value="ChEMBL">Chemistry - ChEMBL</option>
                            <option value="DrugBank">Chemistry - DrugBank</option>
                            <option value="GuidetoPHARMACOLOGY">Chemistry - GuidetoPHARMACOLOGY</option>
                            <option value="SwissLipids">Chemistry - SwissLipids</option>
                            <option value="Allergome">Protein family/group DBs - Allergome</option>
                            <option value="ESTHER">Protein family/group DBs - ESTHER</option>
                            <option value="MEROPS">Protein family/group DBs - MEROPS</option>
                            <option value="CLAE">Protein family/group DBs - CLAE</option>
                            <option value="PeroxiBase">Protein family/group DBs - PeroxiBase</option>
                            <option value="REBASE">Protein family/group DBs - REBASE</option>
                            <option value="TCDB">Protein family/group DBs - TCDB</option>
                            <option value="GlyConnect">PTM DBs - GlyConnect</option>
                            <option value="BioMuta">Genetic variation DBs - BioMuta</option>
                            <option value="DMDM">Genetic variation DBs - DMDM</option>
                            <option value="World-2DPAGE">2D gel DBs - World-2DPAGE</option>
                            <option value="CPTAC">Proteomic DBs - CPTAC</option>
                            <option value="ProteomicsDB">Proteomic DBs - ProteomicsDB</option>
                            <option value="DNASU">Protocols and materials DBs - DNASU</option>
                            <option value="Ensembl">Genome annotation DBs - Ensembl</option>
                            <option value="GeneID">Genome annotation DBs - GeneID</option>
                            <option value="KEGG">Genome annotation DBs - KEGG</option>
                            <option value="PATRIC">Genome annotation DBs - PATRIC</option>
                            <option value="UCSC">Genome annotation DBs - UCSC</option>
                            <option value="WBParaSite">Genome annotation DBs - WBParaSite</option>
                            <option value="ArachnoServer">Organism-specific DBs - ArachnoServer</option>
                            <option value="Araport">Organism-specific DBs - Araport</option>
                            <option value="CGD">Organism-specific DBs - CGD</option>
                            <option value="ConoServer">Organism-specific DBs - ConoServer</option>
                            <option value="dictyBase">Organism-specific DBs - dictyBase</option>
                            <option value="EchoBASE">Organism-specific DBs - EchoBASE</option>
                            <option value="euHCVdb">Organism-specific DBs - euHCVdb</option>
                            <option value="VEuPathDB">Organism-specific DBs - VEuPathDB</option>
                            <option value="FlyBase">Organism-specific DBs - FlyBase</option>
                            <option value="GeneCards">Organism-specific DBs - GeneCards</option>
                            <option value="GeneReviews">Organism-specific DBs - GeneReviews</option>
                            <option value="HGNC">Organism-specific DBs - HGNC</option>
                            <option value="LegioList">Organism-specific DBs - LegioList</option>
                            <option value="Leproma">Organism-specific DBs - Leproma</option>
                            <option value="MaizeGDB">Organism-specific DBs - MaizeGDB</option>
                            <option value="MGI">Organism-specific DBs - MGI</option>
                            <option value="MIM">Organism-specific DBs - MIM</option>
                            <option value="neXtProt">Organism-specific DBs - neXtProt</option>
                            <option value="OpenTargets">Organism-specific DBs - OpenTargets</option>
                            <option value="Orphanet">Organism-specific DBs - Orphanet</option>
                            <option value="PharmGKB">Organism-specific DBs - PharmGKB</option>
                            <option value="PomBase">Organism-specific DBs - PomBase</option>
                            <option value="PseudoCAP">Organism-specific DBs - PseudoCAP</option>
                            <option value="RGD">Organism-specific DBs - RGD</option>
                            <option value="SGD">Organism-specific DBs - SGD</option>
                            <option value="TubercuList">Organism-specific DBs - TubercuList</option>
                            <option value="VGNC">Organism-specific DBs - VGNC</option>
                            <option value="WormBase">Organism-specific DBs - WormBase</option>
                            <option value="Xenbase">Organism-specific DBs - Xenbase</option>
                            <option value="ZFIN">Organism-specific DBs - ZFIN</option>
                            <option value="eggNOG">Phylogenomic DBs - eggNOG</option>
                            <option value="GeneTree">Phylogenomic DBs - GeneTree</option>
                            <option value="HOGENOM">Phylogenomic DBs - HOGENOM</option>
                            <option value="OMA">Phylogenomic DBs - OMA</option>
                            <option value="OrthoDB">Phylogenomic DBs - OrthoDB</option>
                            <option value="TreeFam">Phylogenomic DBs - TreeFam</option>
                            <option value="BioCyc">Enzyme and pathway DBs - BioCyc</option>
                            <option value="Reactome">Enzyme and pathway DBs - Reactome</option>
                            <option value="UniPathway">Enzyme and pathway DBs - UniPathway</option>
                            <option value="PlantReactome">Enzyme and pathway DBs - PlantReactome</option>
                            <option value="ChiTaRS">Miscellaneous - ChiTaRS</option>
                            <option value="GeneWiki">Miscellaneous - GeneWiki</option>
                            <option value="GenomeRNAi">Miscellaneous - GenomeRNAi</option>
                            <option value="PHI-base">Miscellaneous - PHI-base</option>
                            <option value="CollecTF">Gene expression DBs - CollecTF</option>
                            <option value="IDEAL">Family and domain DBs - IDEAL</option>
                            <option value="DisProt">Family and domain DBs - DisProt</option>
                            <option value="UniProtKB">UniProt - UniProtKB</option>
                            <option value="UniProtKB-Swiss-Prot">UniProt - UniProtKB/Swiss-Prot</option>
                            <option value="UniParc">UniProt - UniParc</option>
                            <option value="UniRef50">UniProt - UniRef50</option>
                            <option value="UniRef90">UniProt - UniRef90</option>
                            <option value="UniRef100">UniProt - UniRef100</option>
                            <option value="Gene_Name">UniProt - Gene Name</option>
                            <option value="CRC64">UniProt - CRC64</option>
                            <option value="EMBL-GenBank-DDBJ">Sequence DBs - EMBL/GenBank/DDBJ</option>
                            <option value="EMBL-GenBank-DDBJ_CDS">Sequence DBs - EMBL/GenBank/DDBJ CDS</option>
                            <option value="GI_number">Sequence DBs - GI number</option>
                            <option value="RefSeq_Nucleotide">Sequence DBs - RefSeq Nucleotide</option>
                            <option value="RefSeq_Protein">Sequence DBs - RefSeq Protein</option>
                            <option value="Ensembl_Protein">Genome annotation DBs - Ensembl Protein</option>
                            <option value="Ensembl_Transcript">Genome annotation DBs - Ensembl Transcript</option>
                            <option value="Ensembl_Genomes">Genome annotation DBs - Ensembl Genomes</option>
                            <option value="Ensembl_Genomes_Protein">Genome annotation DBs - Ensembl Genomes Protein</option>
                            <option value="Ensembl_Genomes_Transcript">Genome annotation DBs - Ensembl Genomes Transcript</option>
                            <option value="WBParaSite_Transcript-Protein">Genome annotation DBs - WBParaSite Transcript/Protein</option>
                            <option value="WormBase_Protein">Organism-specific DBs - WormBase Protein</option>
                            <option value="WormBase_Transcript">Organism-specific DBs - WormBase Transcript</option>
                        </param>
                    </when>
                    <when value="UniParc">
                        <expand macro="uniprot_targets">
                            <option value="UniParc">UniProt - UniParc</option>
                        </expand>
                    </when>
                    <when value="UniRef50">
                        <expand macro="uniprot_targets">
                            <option value="UniParc">UniProt - UniParc</option>
                        </expand>
                    </when>
                    <when value="UniRef90">
                        <expand macro="uniprot_targets">
                            <option value="UniParc">UniProt - UniParc</option>
                        </expand>
                    </when>
                    <when value="UniRef100">
                        <expand macro="uniprot_targets">
                            <option value="UniParc">UniProt - UniParc</option>
                        </expand>
                    </when>
                    <when value="Gene_Name">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="CRC64">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="CCDS">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="EMBL-GenBank-DDBJ">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="EMBL-GenBank-DDBJ_CDS">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="GI_number">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="PIR">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="RefSeq_Nucleotide">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="RefSeq_Protein">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="PDB">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="BioGRID">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="ComplexPortal">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="DIP">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="STRING">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="ChEMBL">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="DrugBank">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="GuidetoPHARMACOLOGY">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="SwissLipids">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="Allergome">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="CLAE">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="ESTHER">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="MEROPS">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="PeroxiBase">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="REBASE">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="TCDB">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="GlyConnect">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="BioMuta">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="DMDM">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="World-2DPAGE">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="CPTAC">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="ProteomicsDB">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="DNASU">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="Ensembl">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="Ensembl_Genomes">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="Ensembl_Genomes_Protein">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="Ensembl_Genomes_Transcript">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="Ensembl_Protein">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="Ensembl_Transcript">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="GeneID">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="KEGG">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="PATRIC">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="UCSC">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="WBParaSite">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="WBParaSite_Transcript-Protein">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="ArachnoServer">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="Araport">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="CGD">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="ConoServer">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="dictyBase">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="EchoBASE">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="euHCVdb">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="FlyBase">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="GeneCards">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="GeneReviews">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="HGNC">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="LegioList">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="Leproma">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="MaizeGDB">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="MGI">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="MIM">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="neXtProt">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="OpenTargets">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="Orphanet">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="PharmGKB">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="PomBase">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="PseudoCAP">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="RGD">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="SGD">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="TubercuList">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="VEuPathDB">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="VGNC">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="WormBase">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="WormBase_Protein">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="WormBase_Transcript">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="Xenbase">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="ZFIN">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="eggNOG">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="GeneTree">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="HOGENOM">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="OMA">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="OrthoDB">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="TreeFam">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="BioCyc">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="PlantReactome">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="Reactome">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="UniPathway">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="ChiTaRS">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="GeneWiki">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="GenomeRNAi">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="PHI-base">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="CollecTF">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="DisProt">
                        <expand macro="uniprot_targets"/>
                    </when>
                    <when value="IDEAL">
                        <expand macro="uniprot_targets"/>
                    </when>
                </conditional>
                <expand macro="fields"/>
            </when>
            <when value="retrieve">
                <param name="format" type="select" label="Choose format of output file" help="">
                    <option value="fasta">fasta</option>
                    <option value="gff">gff</option>
                    <option value="txt">embl</option>
                </param>
            </when>
        </conditional>
    </inputs>
    <outputs>
            <data name="outfile_retrieve_fasta" format="fasta" from_work_dir="./output"
                label="${tool.name} on ${on_string}: fasta">
                <filter>tool['tool_choice'] == 'retrieve'</filter>
                <filter>tool['format'] == 'fasta'</filter>
            </data>
            <data name="outfile_retrieve_gff" format="gff" from_work_dir="./output"
                label="${tool.name} on ${on_string}: gff">
                <filter>tool['tool_choice'] == 'retrieve'</filter>
                <filter>tool['format'] == 'gff'</filter>
            </data>
            <data name="outfile_retrieve_txt" format="embl" from_work_dir="./output"
                label="${tool.name} on ${on_string}: embl">
               	<filter>tool['tool_choice'] == 'retrieve'</filter>
                <filter>tool['format'] == 'txt'</filter>
            </data>
            <data name="outfile_map" format="tabular" from_work_dir="./output"
                label="${tool.name} on ${on_string}: mapping">
                <filter>tool['tool_choice'] == 'map'</filter>
            </data>
    </outputs>
    <tests>
        <!-- test fasta output: atm 7 sequences, so we test for 10+-5 header lines, since its multi line fasta we assume at least 5 lines of sequence-->
        <test expect_num_outputs="1">
            <param name="infile" value="id_uniprot.tab" ftype="tabular"/>
            <param name="id_column" value="1"/>
            <conditional name="tool">
                <param name="format" value="fasta"/>
                <param name="tool_choice" value="retrieve"/>
            </conditional>
            <output name="outfile_retrieve_fasta" ftype="fasta">
                <assert_contents>
                    <has_line_matching expression="^>.+$" n="10" delta="5"/>
                    <has_line_matching expression="^[A-Z]+$" min="5"/>
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="1">
            <param name="infile" value="id_uniprot.tab" ftype="tabular"/>
            <param name="id_column" value="1"/>
            <conditional name="tool">
                <param name="format" value="gff"/>
                <param name="tool_choice" value="retrieve"/>
            </conditional>
            <output name="outfile_retrieve_gff" ftype="gff">
                <assert_contents>
                    <has_n_lines min="80"/>
                    <has_text text="UniProtKB"/>
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="1">
            <param name="infile" value="id_uniprot.tab" ftype="tabular"/>
            <param name="id_column" value="1"/>
            <conditional name="tool">
                <param name="format" value="txt"/>
                <param name="tool_choice" value="retrieve"/>
            </conditional>
            <output name="outfile_retrieve_gff" ftype="embl">
                <assert_contents>
                    <has_n_lines min="80"/>
                    <has_text text="UniProtKB"/>
                    <has_line_matching expression="^ID .*"/>
                    <has_line line="//"/>
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="1">
            <param name="infile" value="id_map_refseq.txt" ftype="tabular"/>
            <param name="id_column" value="1"/>
            <conditional name="tool">
                <param name="tool_choice" value="map"/>
                <conditional name="from_cond">
                    <param name="from" value="RefSeq_Nucleotide"/>
                    <param name="to" value="UniProtKB"/>
                </conditional>
            </conditional>
            <output name="outfile_map" file="test2_map.tab" ftype="tabular" sort="true"/>
        </test>
        <!-- map backwards + check if other ID column - no additional fields are in the output -->
        <test expect_num_outputs="1">
            <param name="infile" value="test2_map.tab" ftype="tabular"/>
            <param name="id_column" value="2"/>
            <conditional name="tool">
                <param name="tool_choice" value="map"/>
                <conditional name="from_cond">
                    <param name="from" value="UniProtKB_AC-ID"/>
                    <param name="to" value="RefSeq_Nucleotide"/>
                </conditional>
            </conditional>
            <output name="outfile_map" ftype="tabular">
                <assert_contents>
                    <has_text text="From&#9;To"/>
                    <has_n_columns n="2"/>
                    <has_n_lines n="3"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[

.. class:: infomark

**What it does** 

This tool provides access to the UniProt API. You can retrieve sequence informations given a list of sequence identifiers or map
identifiers between different databases.
Hence, this tool offers you two modes: *map* and *retrieve*.

-----

**INPUT**

The input is a list of IDs.

*Example*::

    Q0P8A9
    A0A077ZHN8
    A0A077ZFY8
    M5B8V9
    M5BAG7
    S0DS17
    ....

-----

**MAP OUTPUT EXAMPLES**

FROM refseq TO embl::

    From    To
    NM_130786    A1BG_HUMAN
    NM_130786    V9HWD8_HUMAN
    NM_001087    A0A024R410_HUMAN
    NM_001087    AAMP_HUMAN
    
FROM uniprot TO genename::

    From        To
    Q0P8A9      fdhC
    A0A077ZHN8  TTRE_0000819801
    A0A077ZFY8  TTRE_0000758701
    M5B8V9      CMN_01519
    M5BAG7      cydC
    S0DS17      FFUJ_00006
    A0A077Z587  TTRE_0000309301
    Q13685      AAMP
    O14639      ABLIM1

-----

**RETRIEVE OUTPUT EXAMPLES**

retrieve gff::

    #gff-version 3
    #sequence-region S0DS17 1 369
    #sequence-region M5BAG7 1 563
    #sequence-region A0A077Z587 1 772
    #sequence-region A0A077ZFY8 1 973
    #sequence-region O14639 1 778
    O14639	UniProtKB	Chain	1	778	.	.	.	ID=PRO_0000075697;Note=Actin-binding LIM protein 1	
    O14639	UniProtKB	Domain	97	156	.	.	.	Note=LIM zinc-binding 1;evidence=ECO:0000255|PROSITE-ProRule:PRU00125	
    O14639	UniProtKB	Domain	156	216	.	.	.	Note=LIM zinc-binding 2;evidence=ECO:0000255|PROSITE-ProRule:PRU00125	
    O14639	Un...

retrieve fasta::

    >tr|S0DS17|S0DS17_GIBF5 Related to cytochrom P450 OS=Gibberella fujikuroi (strain CBS 195.34 / IMI 58289 / NRRL A-6831) GN=FFUJ_00006 PE=3 SV=1
    MSYQSILLRQVNSLCDNLEEVARDENGGLIDMAMQSDYFTFDVMSEVIFGMAYNALKDTS
    YRFVTGALGSSNIRIGTLVQSPLPAMCRIDKY...
    >tr|M5BAG7|M5BAG7_9MICO ABC transporter, fused permease/ABC transporter involved in the biosynthesis of cytochrom bd, fused permease/ATP-binding protein OS=Clavibacter michiganensis subsp. nebraskensis NCPPB 2581 GN=cydC PE=3 SV=1
    MNRDGVLRLAQPPTRRTLPGLLAGLASAVGAVALLATSAWLITRASEQPPILFLGMAIVG
    VRAFALGRAAFRYLERITSHDAAFRALATLRV...
    >tr|A0A077Z587|A0A077Z587_TRITR Kelch 3 and Kelch 4 and Cytochrom B561 domain con taining protein OS=Trichuris trichiura GN=TTRE_0000309301 PE=4 SV=1
    MGSQQAADETQKVVERIILNINVRKDKRSFGLGIKIKKGNVFVSSIRPGSIAEDHFKLYD
    VIKDVNGSRIDSRELCRDLIRTHKVLTV...

-----

This tool is based on the work `Jan Rudolph`_ and the UniProt API.

.. _Jan Rudolph: https://github.com/jdrudolph/uniprot

    ]]></help>
    <citations>
        <citation type="doi">10.1093/nar/gku989</citation>
    </citations>
</tool>
