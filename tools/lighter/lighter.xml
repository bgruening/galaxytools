<tool id="lighter" name="lighter" version="1.0">
    <description>corrects reads containing sequence errors</description>
    <command>
       lighter
       #for $file in $r:
           -r $file
       #end for
       #if str($kmer.k_select) == "smallk":
           -k "${kmer.k_parameter_string}"
       #elif str($kmer.k_select) == "bigK":
           -K "${kmer.k_parameter_string}"
       #end if
       -od ./
       -t \${GALAXY_SLOTS:-4}
       #if $maxcor:
           -maxcor $maxcor
       #end if
       $trim
       $discard
       $noQual
       #if $ascii_quality_score:
           -newQual "${ascii_quality_score}"
       #end if
       $stable
        > $outfile
    </command>
    <inputs>
        <param name="r" multiple="True" type="data" label="Input file"/>
        <conditional name="kmer">
            <param name="k_select" type="select" label="Do you want k or K?">
                <option value="smallk">small k</option>
                <option value="bigK">big K</option>
            </param>
            <when value="smallk">
                <param name="k_parameter_string" size="30" type="text" value="13 20 0.2" label="type in 3 parameters" help="(—k kmer_length genome_size alpha)" />
            </when>
            <when value="bigK">
                <param name="K_parameter_string" size="30" type="text" value="13 20" label="type in 2 parameters" help="(—K kmer_length genome_size)" />
            </when>
        </conditional>
        <param name="maxcor" type="integer" value="4" optional="True" 
            label="Maximum number of correction for within a kmer length window" help="(-maxcor)"/>
        <param name="trim" type="boolean" truevalue="-trim" falsevalue="" checked="False" 
            label="Whether or not to allow trimming"/>
        <param name="discard" type="boolean" truevalue="-discard" falsevalue="" checked="False" 
            label="Whether or not to discard unfixable reads. Will lose paired-end matching when discarding"/>
        <param name="noQual" type="boolean" truevalue="-noQual" falsevalue="" checked="False" 
            label="Whether or not to ignore the quality socre"/>
        <param name="ascii_quality_score" size="30" type="text" value="" optional="True" 
            label="Quality for the bases corrected to the specified score" help="(-newQual)" />
        <param name="stable" type="boolean" truevalue="-stable" falsevalue="" checked="False"
            label="Sequentialize the sampling stage, output the same result with different runs"/>
    </inputs>
    <outputs>
        <data name="outfile" format="r"/>
    </outputs>
    <tests>
        <test>
            <param name="infile" value="input.fq"/>
            <output name="outfile" file="smallk.fq"/>
            <param name="k_select" value="smallk"/>
            <param name="k_parameter_string" value="12 12 0.1"/>
            <param name="noQual" value="True"/>
            <param name="stable" value="False"/>
        </test>
        <test>
            <param name="infile" value="input.fq"/>
            <output name="outfile" file="bigK.fq"/>
            <param name="k_select" value="bigK"/>
            <param name="K_parameter_string" value="20 14"/>
            <param name="noQual" value="False"/>
            <param name="stable" value="True"/>
        </test>
    </tests>
    <help>
**What it does**



Usage: ./lighter [OPTIONS]

OPTIONS:


**Required parameters:**

Input file : fasta fastq or gzip'ed

       The input file can be fasta and fastq,and can be gzip'ed with extension gz.The input file can be either one file or multiple files.
 
Parameters K or k :

       There is a choice which we can choose parameter K or k,with K,we have to type in two parameters kmer_length genome_size, and for k,we have to type in three parameters kmer_length genome_size alpha.

**Other parameters:**

maxcor : 

  Type in the maximum number of correction for within a kmer_length window
 
trim :
 
     Allow trimming

discard :

     Discard unfixable reads. Will lose paired-end matching when discarding
 
noQual :

     Ignore the quality score

newQual : 

    Set the quality for the bases corrected to the specified score
 
stable : 

    Sequentialize the sampling stage, output the same result with different runs
    </help>
    <citations>
        <citation type="doi">10.1186/s13059-014-0509-9</citation>
    </citations>
</tool> 
