<tool id="bia_ftplink" name="FTP Link for Bioimage Archive" version="@VERSION@+galaxy1">
    <description>Get FTP link for a study from Bioimage Archive</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="aggressive">
	    <![CDATA[
		#for $study in $study_name.split(","):
		    curl https://www.ebi.ac.uk/biostudies/api/v1/studies/$study/info -s |jq -r .ftpLink >>ftpLink.txt;
		#end for 
		 
        ]]>
    </command>

    <inputs>
        <param name="study_name" type="text" multiple="true" min="1" label="Study" help="The name(s) of a study in Bioimage Archive.Multiple names are separated by comma. e.g.S-BIAD570,S-BIAD693" />
    </inputs>
    <outputs>
        <data name="ftp_link" format="txt" from_work_dir="ftpLink.txt" label="FTP link for a study in Bioimage Archive" />
    </outputs>
    <tests>
        <test>
	    <param name="study_name" value="S-BIAD570,S-BIAD693" />
	    <output name="ftp_link" ftype="txt" file="ftpLink.txt" lines_diff="0" />
        </test>
        <test>
            <param name="study_name" value="S-BIAD570" />
            <output name="ftp_link" ftype="txt" file="ftpLink_single_value.txt" lines_diff="0" />
        </test>

    </tests>
    <help>
        <![CDATA[
            **What it does**
	    This tool finds the ftp link for a study in the Bioimage Archive
        ]]>
    </help>
    <expand macro="citations" />
</tool>

