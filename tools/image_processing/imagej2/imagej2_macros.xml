<?xml version='1.0' encoding='UTF-8'?>
<macros>
    <xml name="fiji_20141125_requirements">
        <requirements>
            <requirement type="package" version="20141125">fiji</requirement>
        </requirements>
    </xml>
    <xml name="python_bioformats_104_requirements">
        <requirements>
            <requirement type="package" version="20141125">fiji</requirement>
            <requirement type="package" version="1.0.11">javabridge</requirement>
            <requirement type="package" version="1.9">numpy</requirement>
            <requirement type="package" version="1.0.4">python_bioformats</requirement>
        </requirements>
    </xml>
    <xml name="stdio">
        <stdio>
            <exit_code range="1:"/>
            <exit_code range=":-1"/>
            <regex match="Error:"/>
            <regex match="Exception:"/>
        </stdio>
    </xml>
    <xml name="image_type">
        <param name="image_type" type="select" label="Image type">
            <option value="8-bit_white" selected="True">8-bit white</option>
            <option value="8-bit_black">8-bit black</option>
            <option value="8-bit_random">8-bit random</option>
            <option value="8-bit_ramp">8-bit ramp</option>
            <option value="16-bit_white">16-bit white</option>
            <option value="16-bit_black">16-bit black</option>
            <option value="16-bit_random">16-bit random</option>
            <option value="16-bit_ramp">16-bit ramp</option>
            <option value="32-bit_white">32-bit white</option>
            <option value="32-bit_black">32-bit black</option>
            <option value="32-bit_random">32-bit random</option>
            <option value="32-bit_ramp">32-bit ramp</option>
            <option value="RGB_white">RGB white</option>
            <option value="RGB_black">RGB black</option>
            <option value="RGB_random">RGB random</option>
            <option value="RGB_ramp">RGB ramp</option>
        </param>
    </xml>
    <xml name="make_binary_params">
        <param name="iterations" type="integer" value="1" min="1" max="100" label="Iterations" help="The number of times (1-100) erosion, dilation, opening, and closing are performed."/>
        <param name="count" type="integer" value="1" min="1" max="8" label="Count" help="The number of adjacent background pixels necessary (1-8) for erosion or dilation."/>
        <param name="black_background" type="select" label="Black background" help="If Yes, the background is black and the foreground is white (no implies the opposite).">
            <option value="no" selected="True">No</option>
            <option value="yes">Yes</option>
        </param>
        <param name="pad_edges_when_eroding" type="select" label="Pad edges when eroding" help="If Yes, eroding does not erode from the edges of the image.">
            <option value="no" selected="True">No</option>
            <option value="yes">Yes</option>
        </param>
    </xml>
    <token name="@make_binary_args@">
        --iterations $iterations
        --count $count
        --black_background $black_background
        --pad_edges_when_eroding $pad_edges_when_eroding
    </token>
    <xml name="max_heap_size_type_conditional">
        <conditional name="set_max_heap_size">
            <param name="max_heap_size_type" type="select" label="Maximum size of the memory allocation pool used by the JVM" help="This value must be a multiple of 1024 or it will be ignored and the system default will be used.">
                <option value="default" selected="True">Do not set</option>
                <option value="megabytes">Set in megabytes</option>
                <option value="gigabytes">Set in gigabytes</option>
            </param>
            <when value="default" >
                <param name="max_heap_size" type="integer" value="0" hidden="true" label="Do not set" help="Use system default"/>
            </when>
            <when value="megabytes">
                <param name="max_heap_size" type="integer" value="512" min="256" label="Maximum size, in megabytes, of the memory allocation pool" help="Examples: 256, 512, etc."/>
            </when>
            <when value="gigabytes">
                <param name="max_heap_size" type="integer" value="1" min="1" label="Maximum size, in gigabytes, of the memory allocation pool" help="Examples: 1, 2, etc."/>
            </when>
        </conditional>
    </xml>
    <token name="@adjust_threshold_binary_args@">
        --threshold_min $threshold_min
        --threshold_max $threshold_max
        --method $method
        --display $display
        --dark_background $dark_background
        --stack_histogram $stack_histogram
    </token>
    <xml name="adjust_threshold_binary_params">
        <param name="threshold_min" type="float" value="0" min="0" max="255" label="Minimum threshold value" />
        <param name="threshold_max" type="float" value="0" min="0" max="255" label="Maximum threshold value" />
        <param name="method" type="select" label="Method" help="The Default method is the modified IsoData algorithm.">
            <option value="Default" selected="True">Default</option>
            <option value="Huang">Huang</option>
            <option value="Intermodes">Intermodes</option>
            <option value="IsoData">IsoData</option>
            <option value="IJ_IsoData">IJ_IsoData</option>
            <option value="Li">Li</option>
            <option value="MaxEntropy">MaxEntropy</option>
            <option value="Mean">Mean</option>
            <option value="MinError">MinError</option>
            <option value="Minimum">Minimum</option>
            <option value="Moments">Moments</option>
            <option value="Otsu">Otsu</option>
            <option value="RenyiEntropy">RenyiEntropy</option>
            <option value="Shanbhag">Shanbhag</option>
            <option value="Triangle">Triangle</option>
            <option value="Yen">Yen</option>
        </param>
        <param name="display" type="select" label="Display">
            <option value="red" selected="True">Red</option>
            <option value="bw">Black and White</option>
            <option value="over_under">Over/Under</option>
        </param>
        <param name="dark_background" type="select" label="Dark background" help="Select yes if features are lighter than the background.">
            <option value="no" selected="True">No</option>
            <option value="yes">Yes</option>
        </param>
        <param name="stack_histogram" type="select" label="Stack histogram" help="Select yes to first compute the histogram of the whole stack (or hyperstack) and then compute the threshold based on that histogram.">
            <option value="no" selected="True">No</option>
            <option value="yes">Yes</option>
        </param>
    </xml>
    <token name="@max_heap_size_args@">
        --max_heap_size_type $set_max_heap_size.max_heap_size_type
        --max_heap_size $set_max_heap_size.max_heap_size
    </token>
    <xml name="image_datatypes">
        <option value="bmp">bmp</option>
        <option value="gif">gif</option>
        <option value="jpg">jpg</option>
        <option value="png" selected="true">png</option>
        <option value="tiff">tiff</option>
    </xml>
    <xml name="bunwarpj_citations">
        <citations>
            <citation type="bibtex">
                @InProceedings(Arganda-Carreras2006,
                    author =     "Ignacio Arganda-Carreras and
                                        Carlos Oscar S{\'a}nchez Sorzano and
                                        Roberto Marabini and
                                        Jos{\'e} Mar\'{\i}a Carazo and
                                        Carlos Ortiz-de-Solorzano and
                                        Jan Kybic",
                    title =          "Consistent and Elastic Registration of Histological Sections Using Vector-Spline Regularization",    
                    publisher =  "Springer Berlin / Heidelberg",    
                    booktitle =   "Computer Vision Approaches to Medical Image Analysis",
                    series =       "Lecture Notes in Computer Science",
                    year =          "2006",
                    volume =      "4241",
                    pages =       "85-95",
                    month =       "May",
                    city =            "Graz, Austria")
            </citation>
            <citation type="doi">10.1038/nmeth.2019</citation>
        </citations>
    </xml>
    <xml name="fiji_headless_citations">
        <citations>
            <citation type="doi">10.1038/nmeth.2102</citation>
        </citations>
    </xml>
    <xml name="bioformats_fiji_javabridge_citations">
        <citations>
            <citation type="doi">10.1038/nmeth.2102</citation>
            <citation type="doi">10.1038/nmeth.2019</citation>
            <citation type="doi">10.1083/jcb.201004104</citation>
        </citations>
    </xml>
</macros>
