<tool id="coprarna" name="coprarna" version="2.1.0">
  <description>
     Phylogenetic target prediction for prokaryotic trans-acting small RNAs 
  </description>
  <requirements>
    <requirement type="package" version="2.1.0">coprarna</requirement>
  </requirements>
  <command detect_errors="aggressive"><![CDATA[
  CopraRNA.pl
  --srnaseq '$srnaseq'
  --region '$region'
  $ntup 
  $ntdown
  $rcsize 
  $cores 
  $winsize 
  $maxbpdist
  --cons $cons
  $topcount
  $cop1
  $nooi
  $enrich
  $root
    ]]>
  </command>
  <inputs>
    <param name="srnaseq" type="data" format="fasta" label="FASTA file with small RNA sequences"/>
    <param name="region" type="select" label="Region to scan in whole genome target prediction." help="'5utr' for start codon, '3utr' for stop codon, 'cds' for entire transcript">
            <option value="5utr" selected="true">5utr</option>
            <option value="3utr">3utr</option>
            <option value="cds">cds</option>
    </param>
    <param argument="--ntup" type="integer" value="200" label="Nucleotides upstream" help="Number of nucleotides upstream of '--region' to parse for targeting (def:200)" optional="true"/>
    <param argument="--ntdown" type="integer" value="100" label="Nucleotides downstream" help="Number of nucleotides downstream of '--region' to parse for targeting (def:100)" optional="true"/>
    <param argument="--rcsize" type="float" value="0.5" min="0" max="1" label="Fraction of putative target homologs" help="Minimum amount (%) of putative target homologs that need to be available for a target cluster to be considered in the CopraRNA1 part (see --cop1) of the prediction (def:0.5)"/>
    <param argument="--cores" type="integer" value="1" label="CPU cores" help="Number of cores to use for parallel computation (def:1)" optional="true"/>
    <param argument="--winsize" type="integer" value="150" label="Window size" help="IntaRNA target (--tAccW) window size parameter (def:150)" optional="true"/>
    <param argument="--maxbpdist" type="integer" value="100" label="Maximum basepair distance" help="IntaRNA target (--tAccL) maximum base pair distance parameter (def:100)" optional="true"/>
    <param name="cons" type="select" label="Controls consensus prediction" help="'0' for off, '1' for organism of interest based consensus, '2' for overall consensus based prediction">
            <option value="0" selected="true">Off</option>
            <option value="1">Organism of interest based consensus</option>
            <option value="2">Overall consensus based prediction</option>
    </param>
    <param argument="--topcount" type="integer" value="200" label="Top predictions" help="Specifies the number of top predictions to return and use for the extended regions plots (def:200)" optional="true"/>
    <param argument="--cop1" truevalue="--cop1" falsevalue="" checked="False" type="boolean" label="CopraRNA1 prediction" help="Switch for CopraRNA1 prediction (def:off)"/>
    <param argument="--nooi" truevalue="--nooi" falsevalue="" checked="False" type="boolean" label="No focus on the organism of interest" help="If set then the CopraRNA2 prediction mode is set not to focus on the organism of interest (def:off)"/>
    <param argument="--enrich" truevalue="--enrich" falsevalue="" checked="False" type="boolean" label="DAVID-WS functional enrichment" help="If set DAVID-WS functional enrichment is calculated with given number of top predictions (def:off)"/>
    <param argument="--enrich" type="integer" value="0" label="DAVID-WS functional enrichment" help="If set DAVID-WS functional enrichment is calculated with given number of top predictions (def:off)" optional="true"/>
    <param argument="--root" type="float" value="1" label="Root function" help="Specifies root function to apply to the weights (def:1)"/>
  </inputs>
  <outputs>
    <data format="csv" name="result" from_work_dir="./CopraRNA_result.csv" label="CopraRNA result csv"/>
    <data format="txt" name="options" from_work_dir="./CopraRNA_option_file.csv" label="CopraRNA option log"/>
    <data format="pdf" name="conservationheatmap" from_work_dir="./sRNA_conservation_heatmap.pdf" label="sRNA conservation heatmap"/>
    <data format="pdf" name="functionheatmap" from_work_dir="./Enrichment/enriched_heatmap_big.pdf" label="Functional enrichment heatmap"/>
    <data format="tsv" name="clusters" from_work_dir="./cluster.tab" label="clusters"/>
  </outputs>
  <tests>
    <test>
      <param name="srnaseq" value="copra.fa"/>
      <param argument="--ntup" value="75"/>
      <param argument="--ntdown" value="75"/>
      <param argument="--region" value="5utr"/>
      <param argument="--rcsize" value="0.5"/>
      <param argument="--cores" value="1"/>
      <param argument="--winsize" value="150"/>
      <param argument="--maxbpdist" value="100"/>
      <param argument="--enrich" value="200"/>
      <param argument="--cons" value="0"/>
      <output name="result" file="CopraRNA_result.csv"/>
      <output name="options" file="CopraRNA_option_file.csv"/>
      <output name="conservationheatmap" file="sRNA_conservation_heatmap.pdf"/>
      <output name="clusters" file="cluster.tab"/>
      <output name="functionheatmap" file="enriched_heatmap_big.pdf"/>
    </test>
  </tests>
  <help>
    
<![CDATA[
             
**What it does**

Phylogenetic target prediction for prokaryotic trans-acting small RNAs

CopraRNA is a tool for sRNA target prediction. It computes whole genome target predictions by combination of distinct whole genome IntaRNA predictions. As input CopraRNA requires at least 3 homologous sRNA sequences from 3 distinct organisms in FASTA format. Furthermore, each organisms' genome has to be part of the NCBI Reference Sequence (RefSeq) database (i.e. it should have exactly this NZ_* or this NC_XXXXXX format where * stands for any character and X stands for a digit between 0 and 9). Depending on sequence length (target and sRNA), amount of input organisms and genome sizes, CopraRNA can take up to 24h or longer to compute. In most cases it is significantly faster. It is suggested to run CopraRNA on a machine with at least 8 GB of memory.

**Options**
-help : help
-srnaseq : FASTA file with small RNA sequences (def:input_sRNA.fa)
-region : region to scan in whole genome target prediction (def:5utr)
        '5utr' for start codon
        '3utr' for stop codon
        'cds' for entire transcript
-ntup : amount of nucleotides upstream of '--region' to parse for targeting (def:200)
-ntdown : amount of nucleotides downstream of '--region' to parse for targeting (def:100)
-cores : amount of cores to use for parallel computation (def:1)
-rcsize : minimum amount (%) of putative target homologs that need to be available for a target cluster to be considered in the CopraRNA1 part (see --cop1) of the prediction (def:0.5)
-winsize IntaRNA target (--tAccW) window size parameter (def:150)
-maxbpdist IntaRNA target (--tAccL) maximum base pair distance parameter (def:100)
-cop1 switch for CopraRNA1 prediction (def:off)
-cons controls consensus prediction (def:0)
      '0' for off
        '1' for organism of interest based consensus
        '2' for overall consensus based prediction
-verbose : switch to print verbose output to terminal during computation (def:off)
-websrv : switch to provide webserver output files (def:off)
-noclean : switch to prevent removal of temporary files (def:off)
-enrich : if entered then DAVID-WS functional enrichment is calculated with given amount of top predictions (def:off)
-nooi : if set then the CopraRNA2 prediction mode is set not to focus on the organism of interest (def:off)
-root : specifies root function to apply to the weights (def:1)
-topcount : specifies the amount of top predictions to return and use for the extended regions plots (def:200)


**Output**
List of conserved identified interactions

    ]]>

  </help>
  <citations>
    <citation type="doi">10.1073/pnas.1303248110</citation>
    <citation type="doi">10.1093/nar/gku359</citation>
  </citations>
</tool>
