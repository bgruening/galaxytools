<tool id="tssar" name="TSSAR" version="0.1.0">
    <description>A Web Service for predicting bacterial Transcription Start Sites from dRNA-seq data</description>
    <requirements>
        <requirement type="package" version="1.0.1">tssar</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command><![CDATA[
        TSSAR
        --clean
        $cluster
        --range $range
        --score $score
        --winSize $winSize
        --pval $pval
        --minPeak $minPeak
        --g_size $g_size
        --libP '$input_libP'
        --libM '$input_libM'
        > '$output_file'
    ]]></command>
    <inputs>
        <param name="cluster" type="boolean" checked="false" falsevalue="--nocluster" truevalue="--cluster"/>
        <param name="range" type="integer" value="3"/>
        <param name="score" type="boolean" checked="false" falsevalue="d" truevalue="p"/>
        <param name="winSize" type="integer" value="1000 "/>
        <param name="pval" type="float" value="1e-04"/>
        <param name="minPeak" type="integer" value="3"/>
        <param name="g_size" type="integer" value="1000000"/>
        <param type="data" name="input_libP" format="sam"/>
        <param type="data" name="input_libM" format="sam"/>
    </inputs>
    <outputs>
        <data name="output_file" format="txt"/>
    </outputs>
    <tests>
        <test>
            <param name="g_size" value="1640320"/>
            <param name="input_libP" value="S_Acid_TEX_plus.sam"/>
            <param name="input_libM" value="S_Acid_TEX_minus.sam"/>
            <output name="output_file" file="output"/>
        </test>
    </tests>
    <help><![CDATA[
        Usage:
        
        ./TSSAR --libP *libraryP.sam* --libM *libraryM.sam* [--score *p|d*] [--fasta *genome.fa* --g_size *INT*] [--minPeak *INT*] [--pval *FLOAT*] [--winSize *INT*] [--verbose] [--noclean] [--nocluster] [-range *INT*]] [<--tmpdir> *DIR*] [--help|?] [--man]

        Options:
        --libP *libraryP.sam* AND --libM *libraryM.sam*
        Input library (P .. Plus; M .. Minus) in SAM format. The plus
        library is the one with enriched TSS (for dRNA-seq this means that
        the plus library is the treated library, while the minus library is
        the untreated library)

        --fasta *genome.fa* OR --g_size *INT*
        Either the location of reference genome sequence in fasta file
        format OR the genome size in *INT*. The fasta file is only used to
        parse the genome size so just one of the two must be specified.

        --minPeak *INT*
        Minimal Peak size in *INT*. Only positions where read start count in
        the (+)library is greater or equal then *INT* are evaluated to be a
        TSS. Positions with less reads are seen as backgroound noise and not
        considered. Default is *3*.

        --pval *FLOAT*
        Maximal P-value for each position to be annotated as a TSS. Default
        is *1e-04*.

        --winSize *INT*
        Size of the window which slides over the genome and defines the
        statistical properties of the local model. Default is *1,000*.

        --verbose
        If set, some progress reports are printed to STDERR during
        computation.

        --prorata
        If set, the information from the SAM file how many times a read was
        mapped to the genome is used, if present. If the read maps *n* times
        to the genome, each position is counted only *1/n* times. Usefull in
        combination with e.g. segemehl mapper, which can report suboptimal
        mapping positions and/or reports all location where a read maps
        optimally. Default is off.

        --score *p|d*
        If score mode is *p* the p-value is used as score in the TSS BED
        file. If score mode is *d* the peak difference is used as score in
        the TSS BED file. Default is *d*. Also used for clustering, which
        advices to use 'd', since the p-value often becomes zero for
        consecutive positions, thus disabling a proper merging of
        consecutive positions to the best one.

        --nocluster | --cluster
        If --nocluster is set all positions annotated as TSS are reported.
        If --cluster is set consecutive TSS positions are clustered and only
        the 'best' position is reported. 'Best' position depends on the
        setting of --score (see above). Either the position with the lowest
        p-Value or the position with the highest peak difference between
        plus and minus library is reported. Default is --cluster. The option
        --range defines the maximal distance for two significant positions
        to be called 'consecutive'.

        --range *INT*
        The maximal distance for two significant positions to be be
        clustered together if option --cluster is set. Default is *3* nt. If
        --cluster is set to --nocluster, --range is ignored.

        --clean | --noclean
        If --clean is set, all temporary files which are created during the
        computation are deleted afterwards. With --noclean they are stored.
        Mainly for debugging purpose. Default setting is --clean.

        --tmpdir *DIR*
        Specifies where the temporary files should be stored. Default is
        */tmp*.

        --man
        Print a long version of the man-page.

        --[help|?]
        Print a short version of the man-page.
    ]]></help>
    <citations>
        <citation type="doi">10.1186/1471-2105-15-89</citation>
    </citations>
</tool>
