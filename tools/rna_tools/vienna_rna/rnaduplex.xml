<tool id="viennarna_rnaduplex" name="@EXECUTABLE@" version="@VERSION@.0">
    <description>Compute the structure upon hybridization of two RNA strands</description>
    <macros>
        <token name="@EXECUTABLE@">RNAduplex</token>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <expand macro="stdio" />
    <expand macro="version_command" />
    <command>
<![CDATA[
        RNAduplex < '$input' > '$tabularFile'
        -T$temperature -d$dangling --deltaEnergy=$denergy
        #if $varExists('$advancedOptions.noconversion')
            $advancedOptions.noconversion
            $advancedOptions.noLP
            $advancedOptions.noGU
            $advancedOptions.noClosingGU
            $advancedOptions.noTetra
            #if $advancedOptions.nsp
                --nsp='$advancedOptions.nsp'
            #end if
        #end if
]]>
    </command>
    <inputs>
        <param format="fasta" name="input" type="data" label="Fasta file"/>
        <param name="temperature" type="float" value="37.0" label="temperature [°C]" help="-T"/>
        <param name="dangling" type="select" label="how to treat dangling end energies" help="-d">
            <option value="0">0: ignore dangling ends</option>
            <option value="1">1: unpaired bases participate in one dangling end only</option>
            <option value="2" selected="True">2: unpaired bases participate in all dangling ends</option>
            <option value="3">3: allow coaxial stacking</option>
        </param>
        <param argument="--denergy" type="float" value="0.0" label="delta energy range [kcal/mol] for suboptimal structures" help=""/>
        <param argument="--sorted" type="boolean" truevalue="--sorted" falsevalue="" checked="false" label="Sort by energy" help=""/>
        <conditional name="advancedOptions">
            <param name="advancedSelector" type="select" label="advanced options">
                <option value="basic">basic Options</option>
                <option value="advanced">advanced Options</option>
            </param>
            <when value="advanced">
                <param argument="--noconversion" type="boolean" truevalue="" falsevalue="--noconv" checked="true" label="Convert Thymine to Uracil (T -> U)" help="Avoids confusion with DNA sequences"/>
                <param argument="--noLP" type="boolean" truevalue="" falsevalue="--noLP" checked="true" label="Allow lonely base-pairs" help=""/>
                <param argument="--noGU" type="boolean" truevalue="" falsevalue="--noGU" checked="true" label="Allow GU pairing"  help="Allow pairing of G and U at the ends of helices."/>
                <param argument="--noClosingGU" type="boolean" truevalue="" falsevalue="--noClosingGU" checked="true" label="Allow GU pairing at the ends" help="Allow pairing of G and U at the ends of helices."/>
                <param argument="--noTetra" type="boolean" truevalue="" falsevalue="--noTetra" checked="true" label="Allow stabilization for loops, hairpins etc." help=" Include special tabulated stabilizing energies for tri-, tetra- and hexaloop hairpins. Mostly for testing."/>
                <param argument="--nsp" type="text" value="" label="Allow other pairs in addition to the usual AU,GC,and GU pairs."
                   help="Its argument is a comma separated list of additionally allowed pairs. If the first character is '-' then AB will imply that AB and BA are allowed pairs. e.g. RNAfold -nsp -GA  will allow GA and AG pairs. Nonstandard pairs are given 0 stacking energy."/>
            </when>
            <when value="basic">
            </when>
        </conditional>
    </inputs>
    <outputs>
        <data format="txt" name="tabularFile"/>
    </outputs>
    <tests>
        <test>
            <param name="input" value="rnaduplex_input1.fa"/>
            <output name="out_file" file="rnaduplex_result1.txt"/>
        </test>
    </tests>
    <help>
<![CDATA[
**RNAduplex**
RNA duplex reads two RNA sequences and computes optimal and suboptimal secondary structures for their hybridization. The calculation is simplified by allowing only inter−molecular base pairs, for the general case use RNAcofold. The computed optimal and suboptimal structure are written to stdout, one structure per line. Suboptimal structures are computed with energy in a certain range of the optimum (kcal/mol). Default is calculation of mfe structure only.

-----

**Input format**

RNAduplex requires one input file in Fasta format. The secondary strucures will be calculated pairwise: 1st sequence with 2nd sequence, 3rd sequence with 4th sequence, etc.

------

**Outputs**

Each line consist of: The structure in dot bracket format with a "&" separating the two strands. The range of the structure in the two sequences in the format "from,to : from,to"; the energy of duplex structure in kcal/mol. The format is especially useful for computing the hybrid structure between a small probe sequence and a long target sequence.


]]>
    </help>
    <expand macro="citations" />
</tool>
