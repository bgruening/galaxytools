<tool id="ribotaper_create_annotation" name="ribotaper part I: creation of annotation files" version="0.1.0">
    <requirements>
            <requirement type="package">ribotaper</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>

    <command><![CDATA[
        create_annotations_files.bash
            "$gtf"
            "$fa"
            "$ccdsid"
            "$appris"
            "annotation_path"

        &&

        tar
            "czvf"
            "$output2"
            "annotation_path"

    ]]></command>
    <inputs>
        <param name="gtf" type="data" format="GTF" label="GTF"
               help="GTF should contain:
               1) coding and non-coding genes, 2) a 'transcript_id' and a 'gene_id' field for each 'exon' and 'CDS' row.
               "/>
        <param name="fa" type="data" format="fasta" label="Genome fasta file" help="FASTA-format, indexed and not repeat masked"/>
        <param name="ccdsid" type="boolean" falsevalue="false" truevalue="true" checked="true" label="Use ccdsid? (valid for Human Gencode 19 and Mouse Gencode M3 )"
               help="If yes, only exons/transcripts with the CCDS tag will be used as CCDS exons/transcripts, otherwise all exons/transcripts with a CDS region are going to be annotated as CCDS.
                    "/>
        <param name="appris" type="boolean" falsevalue="false" truevalue="true" checked="true" label="Use appris? (valid for Human Gencode 19 and Mouse Gencode M3 )"
               help=" If yes, only exons/transcripts with the appris tag will be used, using only 1 transcript per appris gene (the appris_principal transcript or other appris transcript). If a               gene does not have appris transcript, all the annotated transcript structures are used.
               "/>
    </inputs>
    <outputs>
        <data name="output1" type="data" format="bed" from_work_dir="annotation_path/start_stops_FAR.bed" label="start_stops_FAR"/>
        <data name="output2" type="data" format="compressed_archive" label="annotation_path"/>
    </outputs>
    <tests>
        <test>
            <param name="gtf" value="test.gtf"/>
            <param name="fa" value="test.fa"/>
            <param name="ccdsid" value="true"/>
            <param name="appris" value="true"/>
            <output name="output1" file="annotation_path/start_stops_FAR.bed"/>
        </test>
    </tests>
    <help><![CDATA[
        The Ribotaper tool set consists of three tools: create_annotation_files, create_metaplots and ribotaper.

        Execution of tools should follow the order of create_annotation_files, create_metaplots and ribotaper.

        The current tool is the tool I, create_annotation_files, which should run first, generating two intermediate files -
        start_stops_FAR and annotation_path. These are annotation files for all annotated genes.

        The file, start_stops_FAR, will be used as an input for the tool II, create_metaplots,
        which should run after execution of create_annotation_files.

        The file, annotation_path, will be used as an input for the tool III, ribotaper, which should
        run after execution of create_metaplots.

        It is not necessary for user to understand content of start_stops_FAR and annotation_path.
        However user should make sure selecting start_stops_FAR in the corresponding field when executing create_metaplots,
        and selecting annotation_path in the corresponding field when executing ribotaper.
]]></help>
    <citations>
        <citation type="doi">10.1038/nmeth.3688</citation>
    </citations>
</tool>
