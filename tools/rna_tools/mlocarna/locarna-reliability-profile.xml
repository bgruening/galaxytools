<tool id="locarna_reliability_profile" name="locarna-reliability-profile" version="@VERSION@.0">
    <description>
        Plot reliability profile for probabilistic mlocarna
    </description>

    <macros>
        <import>macros.xml</import>
    </macros>
    
    <expand macro="requirements" />

    <expand macro="stdio" />
    
    <expand macro="version" />
    
    <command><![CDATA[
    tar xzf '$input_archive'
    &&
    reliability-profile.pl mlocarna_results
    --out '$output_plot'
    
    #if str($title) != ""
        --title '$title'
    #end if

    #if str($seqname) != ""
        --seqname $seqname
    #end if

    --beta $beta
    --structure-weight $structure_weight
    
    $predict
    $fit_once_on
    $show_sw
    $rev_compl
    ]]></command>
    
    <inputs>
        <param name="input_archive" type="data" format="tar.gz" label="MLocARNA archive"
               help="Archive of MLocARNA results (generated by running mlocarna in probabilistic alignment mode)." />

        <param name="title" type="text" label="Plot title"
               help="Title of the plot"
               />

        <param name="seqname" type="text" label="Reference sequence"
               help="Project to a reference sequence. Provide one of the sequence names in the alignment input
                     or leave blank to plot without projection."
               />

        <param name="predict" type="boolean" checked="True"
               truevalue="" falsevalue="--dont-predict"
               argument="dont-predict"
               help="Turn on/off predicting."
               />

        <param name="fit_once_on" type="boolean" checked="False"
               truevalue="--fit-once-on" falsevalue=""
               argument="fit-once-on"
               help="Predict exactly one 'on'-region"
               />

        <param name="show_sw" type="boolean" checked="True"
               truevalue="--show-sw" falsevalue=""
               argument="show-sw"
               help="Show the influence of structure weight."
               />

        <param name="rev_compl" type="boolean" checked="False"
               truevalue="--revcompl" falsevalue=""
               argument="revcompl"
               help="Plot and fit a reverse complement."
               />

        <param argument="beta" help="Inverse temperature for fitting." 
               type="float" value="12.0" min="1.0" max="25.0" />
        
        <param name="structure_weight" argument="structure-weight"
               type="float" value="1.0" min="0.0" max="8.0"
               help="Weight of structure against sequence (1.0 means equal)"
               />
        
        <param name="output_format" type="select" 
               label="Output options">
            <option value="pdf" selected="True">Plot in pdf
            format</option>
            <option value="png" selected="False">Plot in png format</option>
        </param>
        
        
    </inputs>
               
    
    <outputs>
        <data format="pdf" name="output_plot"
              label="${tool.name} reliability plot (pdf) ${on_string}">
            <filter>output_format = 'pdf'</filter>
        </data>
        <data format="png" name="output_plot"
              label="${tool.name} reliability plot (png) ${on_string}">
            <filter>output_format = 'png'</filter>
        </data>
    </outputs>
    
    <tests>
        <test>
            <param name="input_data" value="archaea.tar.gz" />
            <output name="output_plot" file="archaea_relplot.pdf" />
        </test>
    </tests>

    <help><![CDATA[**Reliability Profiles for Multiple RNA
Alignment**
    
This tool draws reliability profiles for mlocarna alignments that have
been computed in probabilistic alignment mode. Moreover, it predicts
reliably aligned regions, which can be used to determine the
boundaries of well conserved structured RNA motifs in less closely
related sequence context.
    
**Input.**
Results archive of an alignment by the mlocarna tool; for this
purpose, mlocarna must be run in probabilistic mode in order to
generate the required reliability information.

**Output.**
Plot of the reliability profile for the input alignment. Moreover,
a signal prediction is performed and predicted regions are
annotated in the plot.


For more information, see
.. __: http://www.bioinf.uni-freiburg.de/Software/LocARNA/
    ]]></help>

    <expand macro="citations" />
    
</tool>
