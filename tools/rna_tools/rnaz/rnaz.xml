<tool id="rnaz" name="RNAz" version="2.1.1">
    <description>predicting structurally conserved and thermodynamically stable RNA secondary structures</description>

    <requirements>
        <requirement type="package" version="2.1">rnaz</requirement>
    </requirements>

    <stdio>
        <exit_code range="1:" level="fatal" description="Error occurred. Please check Tool Standard Error" />
        <exit_code range=":-1" level="fatal" description="Error occurred. Please check Tool Standard Error" />
    </stdio>

    <version_command>RNAz --version</version_command>
    <command><![CDATA[
	RNAz 
	--$forward_or_reverse
	$zscore
    $locarnate
    $noshuffle
    #if $cutoff != -1.0:
    --cutoff=$cutoff
    #end if
	'$input'
    > '$output' 
	]]>
    </command>
    <inputs>
        <param format="txt" name="input" type="data" label="Input Alignment File" />
        <param name="forward_or_reverse" type="select" label="Scored strand">
            <option value="forward">Score forward strand (-f)</option>
            <option value="reverse">Score reverse strand (-r)</option>
            <option value="both-strands" selected="true">Score both strands (-b)</option>
        </param>
        <param name="zscore" type="select" label="Which type of z-scores">
            <option value="--mononucleotide">Use mononucleotide shuffled z-scores</option>
            <option value="--dinucleotide" selected="true">Use dinucleotide shuffled z-scores</option>
        </param>
        <param argument="--cutoff" label="Probability cutoff" type="float" value="-1.0" help="-1.0 to deactivate"/>
        <param argument="--locarnate" type="boolean" checked="false" truevalue="--locarnate" falsevalue="" label="Use decision model for structural alignments" />
        <param argument="--no-shuffle" name="noshuffle"  type="boolean" checked="false" truevalue="--no-shuffle" falsevalue="" label="Never fall back to shuffling"  />
    </inputs>
    <outputs>
        <data name="output" format="text" />
    </outputs>
    <tests>
        <test>
            <param name="input" value="unknown.aln.window"/>
            <output name="output" file="unknown.rnaz"/> 
        </test>
        <test>
            <param name="input" value="tRNA.maf.window"/>
            <output name="output" file="tRNA.rnaz"/> 
        </test>
    </tests>
    <help>
		<![CDATA[

**What it does**

RNAz is a program for predicting structurally conserved and thermodynamically stable RNA secondary structures in multiple sequence alignments. It can be used in genome wide screens to detect functional RNA structures, as found in noncoding RNAs and cis-acting regulatory elements of mRNAs.

**Input**

Input is a multiple sequence alignment file. Currently the the following alignment formats can be read: CLUSTALW, FASTA, PHYLIP,NEXUS, MAF, and XMFA. Alignments can be generated by any sequence based alignment program. Sequence alignment tools can be found in Galaxy too (e.g. ClustalW).

Example: 

CLUSTAL 2.1 multiple sequence alignment


sacCer1         GCCTTGTTGGCGCAATCGGTAGCGCGTATGACTCTTAATCATAAGGTTAGGGGTTCGAGC

sacKlu          GCCTTGTTGGCGCAATCGGTAGCGCGTATGACTCTTAATCATAAGGCTAGGGGTTCGAGC

sacBay          GCCTTGTTGGCGCAATCGGTAGCGCGTATGACTCTTAATCATAAGGTTAGGGGTTCGAGC

sacCas          GCTTCAGTAGCTCAGTCGGAAGAGCGTCAGTCTCATAATCTGAAGGTCGAGAGTTCGAAC

\** *   * \** \** \**\** \** \**\**  * *\** \**\**\*  *\**\*    * \**\**\** *


**Output**

RNAz returns an output file consisting of a summary header section and analyzed seuqence windows. For example they look like this:

Header:

Sequences: 4
Columns: 60
Reading direction: forward
Mean pairwise identity:  82.50
Shannon entropy: 0.28395
G+C content: 0.51667
Mean single sequence MFE: -16.67
Consensus MFE: -15.59
Energy contribution: -15.53
Covariance contribution:  -0.06
Combinations/Pair:   1.26
Mean z-score:  -0.66
Structure conservation index:   0.93
Background model: mononucleotide
Decision model: sequence based alignment quality
SVM decision value:  -0.64
SVM RNA-class probability: 0.238023
Prediction: OTHER


Windows:

>sacCer1

GCCUUGUUGGCGCAAUCGGUAGCGCGUAUGACUCUUAAUCAUAAGGUUAGGGGUUCGAGC

..((((...((((........))))....(((((((((((....))))))))))))))). ( -19.00, z-score =  -1.44, R)

>sacKlu

GCCUUGUUGGCGCAAUCGGUAGCGCGUAUGACUCUUAAUCAUAAGGCUAGGGGUUCGAGC

..((((...((((........))))....((((((((..(....)..)))))))))))). ( -16.00, z-score =  -0.11, R)

>sacBay

GCCUUGUUGGCGCAAUCGGUAGCGCGUAUGACUCUUAAUCAUAAGGUUAGGGGUUCGAGC

..((((...((((........))))....(((((((((((....))))))))))))))). ( -19.00, z-score =  -1.44, R)

>sacCas

GCUUCAGUAGCUCAGUCGGAAGAGCGUCAGUCUCAUAAUCUGAAGGUCGAGAGUUCGAAC

.((((((..((((........))))..............)))))).(((......))).. ( -12.69, z-score =   0.35, R)

>consensus

GCCUUGUUGGCGCAAUCGGUAGCGCGUAUGACUCUUAAUCAUAAGGUUAGGGGUUCGAGC

..((((...((((........))))....(((((((((((....))))))))))))))). (-15.59 = -15.53 +  -0.06) 


Usually this is output serves as input to rnazCluster.pl to reassemble sequences from windows often followed by rnazFilter.pl and rnazSort.pl to select regions of interest.

		]]>

    </help>

    <citations>
        <citation type="doi">10.1142/9789814295291_0009</citation>
    </citations>    
    
</tool>
