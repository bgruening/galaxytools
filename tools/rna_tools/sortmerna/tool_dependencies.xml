<?xml version="1.0"?>
<tool_dependency>
    <package name="sortmerna" version="2.0">
        <install version="1.0">
            <actions_group>
                <actions architecture="x86_64" os="linux">
                        <action type="download_by_url" target_filename="sortmerna-2.0.tar.gz">https://github.com/biocore/sortmerna/archive/2.0.tar.gz</action>
                        <action type="autoconf"/>
                        <action type="change_directory">../</action>
                        <action type="make_directory">$INSTALL_DIR/rRNA_databases/</action>
                        <action type="move_directory_files">
                            <source_directory>sortmerna-2.0/rRNA_databases/</source_directory>
                            <destination_directory>$INSTALL_DIR/rRNA_databases/</destination_directory>
                        </action>
                        <action type="set_environment">
                            <environment_variable name="SORTMERNADBDIR" action="set_to">$INSTALL_DIR/rRNA_databases/</environment_variable>
                            <environment_variable name="PATH" action="prepend_to">$INSTALL_DIR/bin</environment_variable>
                        </action>
                    </actions>
                <actions architecture="x86_64" os="darwin">
                        <action type="download_by_url" target_filename="sortmerna-2.0.tar.gz">https://github.com/biocore/sortmerna/archive/2.0.tar.gz</action>
                        <action type="shell_command"><![CDATA[
                            export CC=/opt/local/bin/gcc-mp-4.8 && export CXX=/opt/local/bin/g++-mp-4.8 && ./configure && make && make install
                        ]]>
                        </action>
                        <action type="change_directory">../</action>
                        <action type="make_directory">$INSTALL_DIR/rRNA_databases/</action>
                        <action type="move_directory_files">
                            <source_directory>sortmerna-2.0/rRNA_databases/</source_directory>
                            <destination_directory>$INSTALL_DIR/rRNA_databases/</destination_directory>
                        </action>
                        <action type="set_environment">
                            <environment_variable name="SORTMERNADBDIR" action="set_to">$INSTALL_DIR/rRNA_databases/</environment_variable>
                            <environment_variable name="PATH" action="prepend_to">$INSTALL_DIR/bin</environment_variable>
                        </action>                
                    </actions>
                </actions_group>
        </install>
        <readme>
        SortMeRNA requires g++ 4.8 or later. 

        Note: the Clang compiler on Mac (distributed through Xcode) does not 
        support multithreading. The user is recommended to install the original 
        GCC compiler via MacPorts
        </readme>
    </package>
</tool_dependency>
