<tool id="carveme" name="CarveMe" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="21.05">
    <description>Tool to reconstruct genome-scale metabolic models</description>
    <macros>
        <token name="@TOOL_VERSION@">1.6.0</token>
        <token name="@VERSION_SUFFIX@">0</token>
        <xml name="biotools">
            <xrefs>
                <xref type="bio.tools">CarveMe</xref>
            </xrefs>
        </xml>
    </macros>
    <requirements>
        <requirement type='package' version="@TOOL_VERSION@">carveme</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
    carve '$annotation'
    #if $dna
        --dna
    #end if
    #if $egg
        --egg 
    #end if
    #if $fc2
        --fc2 
    #end if
    #if $cobra
        --cobra 
    #end if
    #if $diamond_args
        --diamond-args '$diamond_args'
    #end if
    #if $universe
        --universe '$universe'
    #end if 
    #if $universe_file
        --universe-file '$universe_file'
    #end if
    #if $mediadb
        --mediadb '$mediadb'
    #end if
    #if $soft
        --soft '$soft'
    #end if
    #if $hard
        --hard '$hard'
    #end if
    #if $reference
        --reference '$reference'
    #end if
    --solver scip
    --output '$model'
    ]]></command>
    <inputs>
    <param name="annotation" label="Annotation file" type="data" format="text" optional="false" multiple="false"/>
    <param argument="--dna" label="Build from DNA FASTA file" type="boolean" truevalue="--dna" falsevalue="" optional="true"/>
    <param argument="--egg" label="Build from eggNOG-mapper annotation file" type="boolean" truevalue="--egg" falsevalue="" optional="true"/>
    <param argument="--fc2" label="Output SBML in sbml-fbc2 format" type="boolean" truevalue="--fc2" falsevalue="" optional="true"/>
    <param argument="--universe" label="Pre-built universe model (default: Bacteria)" type="select" optional="true" multiple="false">
        <option value="grampos">Gram Positive</option>
        <option value="gramneg">Gram Negative</option>
        <option value="cyanobacteria">Cyanobacteria</option>
        <option value="archaea">Archaea</option>
    </param>
    <param argument="--cobra" label="Output SBML in old cobra format" type="boolean" truevalue="--cobra" falsevalue="" optional="true"/>
    <param argument="--diamond_args" label="Additional arguments for running diamond"  type="text" optional="true"/>
    <param argument="--universe_file" label="Reaction universe file (SBML format)"  type="data" format="sbml" optional="true"/>
    <param argument="--mediadb" label="Media database file" type="data" format="tsv" optional="true"/>
    <param argument="--soft" label="Soft constraints file" type="data" format="tsv" optional="true"/>
    <param argument="--hard" label="Hard constraints file" type="data" format="tsv" optional="true"/>
    <param argument="--reference" type="data" format="sbml" optional="true" label="Manually curated model of a close reference species"/>
    </inputs>
    <outputs>
        <data name="model" format="xml"/>
    </outputs>
    <tests>
        <test>
            <param name="annotation" value="protein.faa"/>
            <param name="universe_file" value="e_coli_core.xml"/>
            <output name="model" value="modeltest.xml" ftype='xml' />
        </test>
    </tests>
    <help>

CarveMe reconstructs genome-scale metabolic models of prokaryotes using an annotated genome to 'carve' a universal model.

An annotation input is required as a protein or DNA FASTA file, or, as an eggNOG output.

The default universe is 'bacteria', but alternative, more specific, universes are available for Gram-Positive/Negative, Cyanobacteria and Archaea.

Other universes might be uploaded by the user (e.g. for yeast reconstructions).

Providing a Media database file enforces the model to grow in the said media.

Reactions' directionalities (1:forward, -1:backward, 0:blocked) can be enforced with a soft constraints tabular file:  (e.g R_XXX    -1).

Reactions' bounds can be enforced with a hard constraints tabular file (e.g. R_XXX      -10     10)


Note: Different solvers may result in slightly different models. 
Here, the reconstructions rely on the open source solver SCIP. 
For local installations, CPLEX or Gurobi are faster alternatives.

    </help>
    <citations>
        <citation type="doi">10.1093/nar/gky537</citation>
    </citations>    
</tool>
