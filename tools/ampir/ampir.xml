<tool name="ampir" id="ampir" version="1.1.0">
  <!--Source in git at: https://github.com/fubar2/galaxy_tf_overlay-->
  <!--Created by toolfactory@galaxy.org at 02/09/2023 10:57:21 using the Galaxy Tool Factory.-->
  <description>A toolkit to predict antimicrobial peptides from protein sequences on a genome-wide scale.</description>
  <requirements>
    <requirement version="1.1.0" type="package">r-ampir</requirement>
  </requirements>
  <stdio>
    <exit_code range=":-1" level="fatal" description="Error occurred. Please check Tool Standard Error"/>
    <exit_code range="137" level="fatal_oom" description="Out of Memory"/>
    <exit_code range="1:" level="fatal" description="Error occurred. Please check Tool Standard Error"/>
  </stdio>
  <version_command><![CDATA[echo "1.1.0"]]></version_command>
  <command><![CDATA[#set prefix = "ampir"
#set task_process = "ampir"
Rscript '$runme']]></command>
  <configfiles>
    <configfile name="runme"><![CDATA[#set prefix = "ampir"
#set task_process = "ampir"
#!/usr/bin/env Rscript
library(ampir)
input_seqs = read_faa('${faa}')
prediction = predict_amps(input_seqs,${min_length},model = '${model}')
prediction = prediction[which(prediction\$prob_AMP >= as.numeric(${min_probability})), ]
output_seqs = input_seqs[row.names(prediction), ]
write.table(prediction, file = "$amps_tsv", row.names = FALSE, sep = "\t", quote = FALSE, dec = '.')
df_to_faa(output_seqs, "$amps_faa")
version_file_path = "versions.yml"
version_ampir = paste(unlist(packageVersion("ampir")), collapse = ".")
f = file(version_file_path, "w")
writeLines('"${task_process}":', f)
writeLines("    ampir: ", f, sep = "")
writeLines(version_ampir, f)
close(f)]]></configfile>
  </configfiles>
  <inputs>
    <param name="faa" type="data" optional="false" label="FASTA file containing amino acid sequences" help="" format="fasta" multiple="false"/>
    <param name="min_length" type="integer" value="10" label="Minimum protein length for which predictions will be generated" help=""/>
    <param name="min_probability" type="float" value="0.7" label="Cut-off for AMP prediction" help=""/>
    <param name="model" type="select" label="Built-in model for AMP prediction" help="">
      <option value="precursor">precursor</option>
      <option value="mature">mature</option>
    </param>
  </inputs>
  <outputs>
    <data name="amps_faa" format="fasta" label="File containing AMP predictions in amino acid FASTA format" hidden="false"/>
    <data name="amps_tsv" format="tabular" label="File containing AMP predictions in TSV format" hidden="false"/>
  </outputs>
  <tests>
    <test>
      <output name="amps_faa" value="amps_faa_sample" compare="sim_size" delta="1000"/>
      <output name="amps_tsv" value="amps_tsv_sample" compare="sim_size" delta="1000"/>
      <param name="faa" value="faa_sample"/>
      <param name="min_length" value="10"/>
      <param name="min_probability" value="0.7"/>
      <param name="model" value="precursor"/>
    </test>
  </tests>
  <help><![CDATA[description: A toolkit to predict antimicrobial peptides from protein sequences on a genome-wide scale.



homepage: https://github.com/Legana/ampir



documentation: https://cran.r-project.org/web/packages/ampir/index.html



tool_dev_url: https://github.com/Legana/ampir



doi: 10.1093/bioinformatics/btaa653



licence: ['GPL v2']


]]></help>
  <citations>
    <citation type="doi">10.1093/bioinformatics/bts573</citation>
  </citations>
</tool>

