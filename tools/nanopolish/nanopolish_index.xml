<tool id="nanopolish_index" name="Index raw and basecalled reads" version="0.1.0">
    <requirements>
        <requirement type="package" version="0.9.0">nanopolish</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
    	mkdir fast5_files_galaxy/ && cp $input1 input1.fasta && cp $input2 fast5_files_galaxy/input2.fast5 && cp $input3 fast5_files_galaxy/input3.fast5 &&
        nanopolish index -d fast5_files_galaxy/ input1.fasta && ls -all .
    ]]></command>
    <inputs>
        <param type="data" name="input1" format="fasta" />
        <param type="data" name="input2" format="h5" />
        <param type="data" name="input3" format="h5" />
    </inputs>
    <outputs>
        <data name="output1" format="nanopolish_index" from_work_dir="input1.fasta.index"  />
    </outputs>
    <tests>
        <test>
            <param name="input1" ftype="fasta" value="reads.fasta"/>
            <param name="input2" ftype="h5" value="fast5_files_test/odw_genlab4209_20161213_FN_MN16303_sequencing_run_sample_id_32395_ch107_read4268_strand.fast5"/>
            <param name="input3" ftype="h5" value="fast5_files_test/odw_genlab4209_20161213_FN_MN16303_sequencing_run_sample_id_32395_ch109_read2202_strand.fast5"/>
            <output name="output1" file="reads.fasta.index"/>
        </test>
    </tests>
    <help><![CDATA[
		Usage: nanopolish index [OPTIONS] -d nanopore_raw_file_directory reads.fastq
		Build an index mapping from basecalled reads to the signals measured by the sequencer
  		-v, --verbose                        display verbose output
  		-d, --directory                      path to the directory containing the raw ONT signal files.
  		-s, --sequencing-summary             the sequencing summary file from albacore, providing this option will make indexing much faster
  		-f, --summary-fofn                   file containing the paths to the sequencing summary files (one per line)
    ]]></help>
    <citations>
        <citation type="doi">10.1038/nmeth.4184</citation>
        <citation type="bibtex">
@misc{githubnanopolish,
  author = {LastTODO, FirstTODO},
  year = {TODO},
  title = {nanopolish},
  publisher = {GitHub},
  journal = {GitHub repository},
  url = {https://github.com/jts/nanopolish},
}</citation>
    </citations>
</tool>