<tool id="t_coffee" name="T-Coffee" profile="16.04" version="0.1">
    <requirements>
        <requirement type="package" version="11.0.8">t_coffee</requirement>
    </requirements>
    <command><![CDATA[
        t_coffee

        -in "$input"

        #if $method1:
            M"$method1"
        #end if

        #if $method2:
            M"$method2"
        #end if

        #if $method3:
            M"$method3"
        #end if

        #if $out:
            -output "$out"
        #end if
]]>
    </command>
    <inputs>
        <param name="input" type="data" format="fasta" label="Sequences in FASTA format" />

        <param name="method1" type="select" label="Pairwise Sequence Alignment Method" optional="True">
            <option value="fast_pair">fast</option>
            <option value="exon3_pair">exon3</option>
            <option value="exon2_pair">exon2</option>
            <option value="exon_pair">exon</option>
            <option value="slow_pair">slow</option>
            <option value="proba_pair">probA</option>
            <option value="lalign_id_pair">lalign id</option>
            <option value="seq_pair">seq</option>
            <option value="externprofile_pair">externprofile</option>
            <option value="hh_pair">hh</option>
            <option value="profile_pair">profile</option>
            <option value="cdna_fast_pair">cdna fast</option>
            <option value="cdna_cfast_pair">cdna cfast</option>
            <option value="clustalw_pair">ClustalW</option>
            <option value="mafft_pair">mafft</option>
            <option value="mafftjtt_pair">mafftjtt</option>
            <option value="mafftgins_pair">mafftgins</option>
            <option value="dialignt_pair">dialign-t</option>
            <option value="poa_pair">poa</option>
            <option value="probcons_pair">ProbCons</option>
            <option value="muscle_pair">Muscle</option>
            <option value="t_coffee_pair">T-Coffee</option>
            <option value="pcma_pair">pcma</option>
            <option value="kalign_pair">kalign</option>
            <option value="amap_pair">amap</option>
            <option value="proda_pair">proda</option>
            <option value="prank_pair">prank</option>
            <option value="consan_pair">consan</option>
        </param>

        <param name="method2" type="select" label="Pairwise Structural Alignment Method" optional="True">
            <option value="align_pdbpair">align_pdb</option>
            <option value="lalign_pdbpair">lalign_pdb</option>
            <option value="extern_pdbpair">extern_pdb</option>
            <option value="thread_pair">thread</option>
            <option value="fugue_pair">fugue</option>
            <option value="pdb_pair">pdb</option>
            <option value="sap_pair">sap</option>
            <option value="mustang_pair">mustang</option>
            <option value="tmalign_pair">tmalign</option>
        </param>

        <param name="method3" type="select" label="Multiple Sequence Alignment Method" optional="True">
            <option value="clustalw_msa">ClustalW</option>
            <option value="mafft_msa">mafft</option>
            <option value="mafftjtt_msa">mafftjtt</option>
            <option value="mafftgins_msa">mafftgins</option>
            <option value="dialigntx_msa">dialign-tx</option>
            <option value="dialignt_msa">dialign-t</option>
            <option value="poa_msa">poa</option>
            <option value="probcons_msa">ProbCons</option>
            <option value="muscle_msa">Muscle</option>
            <option value="t_coffee_msa">T-Coffee</option>
            <option value="pcma_msa">pcma</option>
            <option value="kalign_msa">kalign</option>
            <option value="amap_msa">amap</option>
            <option value="proda_msa">proda</option>
            <option value="prank_msa">prank</option>
        </param>

        <param name="out" type="select" multiple="true" label="Output Format">
            <!-- <option value="format_dnd">Newick</option> -->
            <option value="msf_aln">MSF alignment</option>
            <option value="clustalw_aln">ClustalW format</option>
            <option value="pir_aln">pir alignment</option>
            <option value="fasta_aln">FASTA alignment</option>
            <option value="phylip">Phylip format</option>
            <option value="pir_seq">pir sequences (no gap)</option>
            <option value="fasta_seq">FASTA sequences (no gap)</option>
            <option value="score_ascii">Score ASCII</option>
            <option value="score_html">Score HTML</option>
        </param>
    </inputs>
    <outputs>
        <!-- <data format="nhx" name="dnd" label="${tool.name} on ${on_string}: newick.dnd" >
          <filter>out == "dnd"</filter>
        </data> -->
        <data format="msf" name="msf_aln" label="${tool.name} on ${on_string}: msf_aln" >
          <filter>"msf_aln" in out</filter>
        </data>
        <data format="clustalw" name="clustalw_aln" label="${tool.name} on ${on_string}: clustalw_aln" >
          <filter>"clustalw_aln" in out</filter>
        </data>
        <data format="pir" name="pir_aln" label="${tool.name} on ${on_string}: pir_aln" >
          <filter>"pir_aln" in out</filter>
        </data>
        <data format="fasta" name="fasta_aln" label="${tool.name} on ${on_string}: fasta_aln" >
          <filter>"fasta_aln" in out</filter>
        </data>
        <data format="phyloxml" name="phylip" label="${tool.name} on ${on_string}: phylip" >
          <filter>"phylip" in out</filter>
        </data>
        <data format="pir" name="pir_seq" label="${tool.name} on ${on_string}: pir_seq" >
          <filter>"pir_seq" in out</filter>
        </data>
        <data format="fasta" name="fasta_seq" label="${tool.name} on ${on_string}: fasta_seq" >
          <filter>"fasta_seq" in out</filter>
        </data>
        <data format="ascii" name="score_ascii" label="${tool.name} on ${on_string}: score_ascii" >
          <filter>"score_ascii" in out</filter>
        </data>
        <data format="html" name="score_html" label="${tool.name} on ${on_string}: score_html" >
          <filter>"score_html" in out</filter>
        </data>
    </outputs>
    <tests>
        <test>
            <param name="input" value="tcoffee_in.fasta" ftype= "fasta" />
            <param name="out" value="fasta_aln" />
            <output name="fasta_aln" file="tcoffee_out.fasta" ftype= "fasta" />
        </test>
    </tests>
    <help>
**What is T-Coffee**

`T-Coffee`_ is a multiple sequence alignment package. You can use T-Coffee to align sequences or to combine the output of your favorite alignment methods (Clustal, Mafft, Probcons, Muscle...) into one unique alignment (`M-Coffee`_).

T-Coffee can align Protein, DNA and RNA sequences. It is also able to combine sequence information with protein structural information (`3D-Coffee/Expresso`_), profile information (PSI-Coffee) or RNA secondary structures (`R-Coffee`_).

.. _T-Coffee:           http://www.tcoffee.org/Projects/tcoffee/
.. _M-Coffee:           http://www.tcoffee.org/Projects/mcoffee/index.html
.. _3D-Coffee/Expresso: http://www.tcoffee.org/Projects/expresso/index.html
.. _R-Coffee:           http://www.tcoffee.org/Projects/rcoffee/index.html
    </help>
    <tests>
        <test>
            <param name="input" value="tcoffe_in.fasta" ftype= "fasta"/>
            <param name="out" value="fasta_aln"/>
            <output name="fasta_aln" file="tcoffee_out.fasta" ftype= "fasta"/>
        </test>
    </tests>
    <citations>
        <citation type="bibtex">
            @article{JMB,
                author = {CÃ©dric Notredame, Desmond G. Higgins and Jaap Heringa},
                year = {2000},
                title = {T-Coffee: A Novel Method for Fast and Accurate Multiple Sequence Alignment},
                publisher = {JMB},
                journal = {JMB},
                url = {http://www.tcoffee.org/Publications/Pdf/tcoffee.pdf},
            }
        </citation>
    </citations>
</tool>
