<tool id="mlocarna" name="mlocarna" version="0.1.0" >

  <requirements>

      <requirement type="package" version='1.8.10'>locarna</requirement>
      <requirement type="package" version='0.07'>perl-math-round</requirement>


  </requirements>

    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command>
        <![CDATA[

		    perl '$__tool_directory__/newMloc.pl'  '$center_fa_file' '$tree_file' $p $max_diff_am $tau $max_diff '$__tool_directory__' '$data_map' $plfold_minlen
        ]]>
</command>
    <inputs>

        <param type="data" name="center_fa_file" label="centers" format="fa, fasta" help="fasta format" />
        <param type="data" name="tree_file" label="trees" format="text" help="text format" />
        <param type="data" name="data_map" label="data_map" format="txt" help="text format" />


        <param name="p" type="float" value="0.001" size="5" label="minimal probability" help="-p">
          <sanitizer>
               <valid initial="string.printable">
                  <remove value="&apos;"/>
               </valid>
           </sanitizer>
        </param>
        <param name="max_diff_am" type="integer" value="50" size="5" label=" maximal difference for sizes of matched arcs" help="--max-diff-am">
          <sanitizer>
               <valid initial="string.printable">
                  <remove value="&apos;"/>
               </valid>
           </sanitizer>
        </param>
        <param name="tau" type="integer" value="50" size="5" label="Tau factor in percent" help="--tau">
          <sanitizer>
               <valid initial="string.printable">
                  <remove value="&apos;"/>
               </valid>
           </sanitizer>
        </param>
        <param name="max_diff" type="integer" value="100" size="5" label="maximal difference for alignment traces" help="--max-diff">
          <sanitizer>
               <valid initial="string.printable">
                  <remove value="&apos;"/>
               </valid>
           </sanitizer>
        </param>

        <param name="plfold_minlen" type="integer" value="210" size="5" label="Minimal length of a sequences for which RNAplfold is used" >
          <sanitizer>
               <valid initial="string.printable">
                  <remove value="&apos;"/>
               </valid>
           </sanitizer>
        </param>

    </inputs>

    <outputs>

	        <data name="model_tree_stk" format="stockholm" label="model.tree.stk" from_work_dir="MODEL/best_subtree.aln" />

    </outputs>
    <tests>
        <test>
            <param name="tree_file" value="1.1.tree"/>
            <param name="center_fa_file" value="1.1.center.fa"/>
            <param name="data_map" value="data.map"/>
            <param name="p" value="0.001"/>
            <param name="max-diff-am" value="50"/>
            <param name="tau" value="50"/>
            <param name="max-diff-am" value="100"/>
            <output name="model_tree_stk" file="best_subtree.aln"/>
        </test>
    </tests>
    <help>
        <![CDATA[
**What it does**

MLocARNA computes a multiple sequence-structure alignment of RNA sequences.
It uses *treefile* - file with guide tree in NEWICK format. The given tree is used as guide tree for the progressive alignment.
This saves the calculation of pairwise all-vs-all similarities and construction of the guide tree.



]]>
    </help>
    <citations>

      </citations>
</tool>
