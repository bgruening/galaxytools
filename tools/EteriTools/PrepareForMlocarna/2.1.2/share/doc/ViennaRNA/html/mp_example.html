<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>RNAlib-2.1.2: Example - A Small Example Program</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<h1><a class="anchor" name="mp_example">Example - A Small Example Program</a></h1>_utils Utilities - Odds and Ends<p>
<a class="anchor" name="toc"></a><p>
<h3>Table of Contents</h3>
<p>
<hr>
<p>
<ul>
<li><a class="el" href="mp_example.html#utils_ss">Producing secondary structure graphs</a> </li>
<li><a class="el" href="mp_example.html#utils_dot">Producing (colored) dot plots for base pair probabilities</a> </li>
<li><a class="el" href="mp_example.html#utils_aln">Producing (colored) alignments</a> </li>
<li><a class="el" href="mp_example.html#utils_seq">RNA sequence related utilities</a> </li>
<li><a class="el" href="mp_example.html#utils_struc">RNA secondary structure related utilities</a> </li>
<li><a class="el" href="mp_example.html#utils_misc">Miscellaneous Utilities</a></li>
</ul>
<hr>
<h2><a class="anchor" name="utils_ss">
Producing secondary structure graphs</a></h2>
<div class="fragment"><pre class="fragment">int PS_rna_plot ( char *string,
                  char *structure,
                  char *file)
</pre></div>  <a class="el" href="PS__dot_8h.html#f7ce1bb2a3480d201c052c8dcac1d848">PS_rna_plot()</a><p>
<div class="fragment"><pre class="fragment">int PS_rna_plot_a (
            char *string,
            char *structure,
            char *file,
            char *pre,
            char *post)
</pre></div>  <a class="el" href="PS__dot_8h.html#c72680a16fe448908d3a6463b465b4c8">PS_rna_plot_a()</a><p>
<div class="fragment"><pre class="fragment">int gmlRNA (char *string,
            char *structure,
            char *ssfile,
            char option)
</pre></div>  <a class="el" href="PS__dot_8h.html#1a2cab4e1ebf31b24261a25b6741253b">gmlRNA()</a><p>
<div class="fragment"><pre class="fragment">int ssv_rna_plot (char *string,
                  char *structure,
                  char *ssfile)
</pre></div>  <a class="el" href="PS__dot_8h.html#acfde04e76d83eee9071a182a864f9d5">ssv_rna_plot()</a><p>
<div class="fragment"><pre class="fragment">int svg_rna_plot (char *string,
                  char *structure,
                  char *ssfile)
</pre></div>  <a class="el" href="PS__dot_8h.html#be977068d1eb713dc3153a977245cadb">svg_rna_plot()</a><p>
<div class="fragment"><pre class="fragment">int xrna_plot ( char *string,
                char *structure,
                char *ssfile)
</pre></div>  <a class="el" href="PS__dot_8h.html#8b339233acda2304031ebafbad51e277">xrna_plot()</a><p>
<div class="fragment"><pre class="fragment">int rna_plot_type
</pre></div>  rna_plot_type<p>
Two low-level functions provide direct access to the graph lauyouting algorithms:<p>
<div class="fragment"><pre class="fragment">int simple_xy_coordinates ( short *pair_table,
                            float *X,
                            float *Y)
</pre></div>  <a class="el" href="plot__layouts_8h.html#7ce9669657183f9bdafa8d669bc3b7f3">simple_xy_coordinates()</a><p>
<div class="fragment"><pre class="fragment">int naview_xy_coordinates ( short *pair_table,
                            float *X,
                            float *Y)
</pre></div>  naview_xy_coordinates()<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="PS__dot_8h.html">PS_dot.h</a> and <a class="el" href="naview_8h.html">naview.h</a> for more detailed descriptions.</dd></dl>
 
<hr>
<a href="#toc">Table of Contents</a>
<hr>
<h2><a class="anchor" name="utils_dot">
Producing (colored) dot plots for base pair probabilities</a></h2>
<div class="fragment"><pre class="fragment">int PS_color_dot_plot ( char *string,
                        cpair *pi,
                        char *filename)
</pre></div>  PS_color_dot_plot()<p>
<div class="fragment"><pre class="fragment">int PS_color_dot_plot_turn (char *seq,
                            cpair *pi,
                            char *filename,
                            int winSize)
</pre></div>  PS_color_dot_plot_turn()<p>
<div class="fragment"><pre class="fragment">int PS_dot_plot_list (char *seq,
                      char *filename,
                      plist *pl,
                      plist *mf,
                      char *comment)
</pre></div>  <a class="el" href="PS__dot_8h.html#e19d5a95620133d9d0b9e686e8b7b21a">PS_dot_plot_list()</a><p>
<div class="fragment"><pre class="fragment">int PS_dot_plot_turn (char *seq,
                      struct plist *pl,
                      char *filename,
                      int winSize)
</pre></div>  PS_dot_plot_turn()<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="PS__dot_8h.html">PS_dot.h</a> for more detailed descriptions.</dd></dl>
<h2><a class="anchor" name="utils_aln">
Producing (colored) alignments</a></h2>
<div class="fragment"><pre class="fragment">int PS_color_aln (
            const char *structure,
            const char *filename,
            const char *seqs[],
            const char *names[])
</pre></div>  PS_color_aln()<p>
 
<hr>
<a href="#toc">Table of Contents</a>
<hr>
<h2><a class="anchor" name="utils_seq">
RNA sequence related utilities</a></h2>
Several functions provide useful applications to RNA sequences<p>
<div class="fragment"><pre class="fragment">char  *random_string (int l,
                      const char symbols[])
</pre></div>  <a class="el" href="utils_8h.html#95cfb010006f3ca6b6bcb4dfe8b50059">random_string()</a><p>
<div class="fragment"><pre class="fragment">int   hamming ( const char *s1,
                const char *s2)
</pre></div>  <a class="el" href="utils_8h.html#fcf5e47ee5c79af67af8992b7a251223">hamming()</a><p>
<div class="fragment"><pre class="fragment">void str_DNA2RNA(char *sequence);
</pre></div>  <a class="el" href="utils_8h.html#fbe81f36a52574b41919655f071aebde">str_DNA2RNA()</a><p>
<div class="fragment"><pre class="fragment">void str_uppercase(char *sequence);
</pre></div>  <a class="el" href="utils_8h.html#dabc7ac69c1ccbf96ee859b78c80592f">str_uppercase()</a><p>
 
<hr>
<a href="#toc">Table of Contents</a>
<hr>
<h2><a class="anchor" name="utils_struc">
RNA secondary structure related utilities</a></h2>
<div class="fragment"><pre class="fragment">char *pack_structure (const char *struc)
</pre></div>  <a class="el" href="utils_8h.html#512a80f073ad7dc3da7a640102496579">pack_structure()</a><p>
<div class="fragment"><pre class="fragment">char *unpack_structure (const char *packed)
</pre></div>  <a class="el" href="utils_8h.html#066fddaf0f6cb0e0654aa7b4465e40d2">unpack_structure()</a><p>
<div class="fragment"><pre class="fragment">short *make_pair_table (const char *structure)
</pre></div>  <a class="el" href="utils_8h.html#f405ebc979e35f06a2834333c5d2532c">make_pair_table()</a><p>
<div class="fragment"><pre class="fragment">short *copy_pair_table (const short *pt)
</pre></div>  <a class="el" href="utils_8h.html#7864eec7dcf8be8dd0baf738c98ccb30">copy_pair_table()</a><p>
 
<hr>
<a href="#toc">Table of Contents</a>
<hr>
<h2><a class="anchor" name="utils_misc">
Miscellaneous Utilities</a></h2>
<div class="fragment"><pre class="fragment">void print_tty_input_seq (void)
</pre></div>  <a class="el" href="utils_8h.html#acf2afdab7485c35a3295de0d8c0dc62">print_tty_input_seq()</a><p>
<div class="fragment"><pre class="fragment">void print_tty_constraint_full (void)
</pre></div>  <a class="el" href="utils_8h.html#163cab70a4be347d76df004e63c3e3a9">print_tty_constraint_full()</a><p>
<div class="fragment"><pre class="fragment">void print_tty_constraint (unsigned int option)
</pre></div>  <a class="el" href="utils_8h.html#d4379c5248591e903c2d0061b610e4bc">print_tty_constraint()</a><p>
<div class="fragment"><pre class="fragment">int   *get_iindx (unsigned int length)
</pre></div>  <a class="el" href="utils_8h.html#361bacacd3717eb1b96c0a8dbae2184d">get_iindx()</a><p>
<div class="fragment"><pre class="fragment">int   *get_indx (unsigned int length)
</pre></div>  <a class="el" href="utils_8h.html#89ddf44c570bb2b0893aa76525275fdd">get_indx()</a><p>
<div class="fragment"><pre class="fragment">void constrain_ptypes (
                const char *constraint,
                unsigned int length,
                char *ptype,
                int *BP,
                int min_loop_size,
                unsigned int idx_type)
</pre></div>  <a class="el" href="utils_8h.html#9a4d418db794bd36f4f1681f0ae2b3b0">constrain_ptypes()</a><p>
<div class="fragment"><pre class="fragment">char  *get_line(FILE *fp);
</pre></div>  <a class="el" href="utils_8h.html#534a8f548b75e7aa7189ae5c50f45ef4">get_line()</a><p>
<div class="fragment"><pre class="fragment">unsigned int read_record(
                char **header,
                char **sequence,
                char ***rest,
                unsigned int options);
</pre></div>  <a class="el" href="utils_8h.html#636f2b61332f86184f72acedf276d1c1">read_record()</a><p>
<div class="fragment"><pre class="fragment">char  *time_stamp (void)
</pre></div>  <a class="el" href="utils_8h.html#0a3e429ef54025ba1bfd246e97eeae25">time_stamp()</a><p>
<div class="fragment"><pre class="fragment">void warn_user (const char message[])
</pre></div>  <a class="el" href="utils_8h.html#a2b2c3e83d76b53455b7b3701b9f2fe9">warn_user()</a><p>
<div class="fragment"><pre class="fragment">void nrerror (const char message[])
</pre></div>  <a class="el" href="utils_8h.html#0b4244d16c7814c329c79f78695829f8">nrerror()</a><p>
<div class="fragment"><pre class="fragment">void   init_rand (void)
</pre></div>  <a class="el" href="utils_8h.html#8dfeabde9f7b0a332554090d46073987">init_rand()</a><p>
<div class="fragment"><pre class="fragment">unsigned short xsubi[3];
</pre></div>  xsubi<p>
<div class="fragment"><pre class="fragment">double urn (void)
</pre></div>  <a class="el" href="utils_8h.html#80338abe87350131e92d705cada17655">urn()</a><p>
<div class="fragment"><pre class="fragment">int    int_urn (int from, int to)
</pre></div>  <a class="el" href="utils_8h.html#b17b6f164204698a8d126445e0a45c5d">int_urn()</a><p>
<div class="fragment"><pre class="fragment">void  *space (unsigned size)
</pre></div>  <a class="el" href="utils_8h.html#7261b88efae2d25e6121db2f28e86227">space()</a><p>
<div class="fragment"><pre class="fragment">void  *xrealloc ( void *p,
                  unsigned size)
</pre></div>  <a class="el" href="utils_8h.html#d73da84e51499eea58b5d8b99996567d">xrealloc()</a><p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="utils_8h.html">utils.h</a> for a complete overview and detailed description of the utility functions</dd></dl>
 
<hr>
<a href="#toc">Table of Contents</a>
<hr>
<p>
<a class="el" href="mp_example.html">Next Page: Examples</a><p>
The following program exercises most commonly used functions of the library. The program folds two sequences using both the mfe and partition function algorithms and calculates the tree edit and profile distance of the resulting structures and base pairing probabilities.<p>
<div class="fragment"><pre class="fragment"> {.c}
<span class="preprocessor">#include  &lt;stdio.h&gt;</span>
<span class="preprocessor">#include  &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include  &lt;math.h&gt;</span>
<span class="preprocessor">#include  &lt;string.h&gt;</span>
<span class="preprocessor">#include  "<a class="code" href="utils_8h.html">utils.h</a>"</span>
<span class="preprocessor">#include  "<a class="code" href="fold__vars_8h.html">fold_vars.h</a>"</span>
<span class="preprocessor">#include  "<a class="code" href="fold_8h.html">fold.h</a>"</span>
<span class="preprocessor">#include  "<a class="code" href="part__func_8h.html">part_func.h</a>"</span>
<span class="preprocessor">#include  "<a class="code" href="inverse_8h.html">inverse.h</a>"</span>
<span class="preprocessor">#include  "<a class="code" href="RNAstruct_8h.html">RNAstruct.h</a>"</span>
<span class="preprocessor">#include  "<a class="code" href="treedist_8h.html">treedist.h</a>"</span>
<span class="preprocessor">#include  "<a class="code" href="stringdist_8h.html">stringdist.h</a>"</span>
<span class="preprocessor">#include  "<a class="code" href="profiledist_8h.html">profiledist.h</a>"</span>

<span class="keywordtype">void</span> main()
{
   <span class="keywordtype">char</span> *seq1=<span class="stringliteral">"CGCAGGGAUACCCGCG"</span>, *seq2=<span class="stringliteral">"GCGCCCAUAGGGACGC"</span>,
        *struct1,* struct2,* xstruc;
   <span class="keywordtype">float</span> e1, e2, tree_dist, string_dist, profile_dist, kT;
   Tree *T1, *T2;
   swString *S1, *S2;
   <span class="keywordtype">float</span> *pf1, *pf2;
   FLT_OR_DBL *bppm;
   <span class="comment">/* fold at 30C instead of the default 37C */</span>
   <a class="code" href="fold__vars_8h.html#0b516316c5f7ab02f8d1a9fbc1ba2fbb">temperature</a> = 30.;      <span class="comment">/* must be set *before* initializing  */</span>

   <span class="comment">/* allocate memory for structure and fold */</span>
   struct1 = (<span class="keywordtype">char</span>* ) <a class="code" href="utils_8h.html#7261b88efae2d25e6121db2f28e86227">space</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*(strlen(seq1)+1));
   e1 =  <a class="code" href="group__mfe__fold.html#gd11bb36c69e7e75f0bbae81a6642a015">fold</a>(seq1, struct1);

   struct2 = (<span class="keywordtype">char</span>* ) <a class="code" href="utils_8h.html#7261b88efae2d25e6121db2f28e86227">space</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*(strlen(seq2)+1));
   e2 =  <a class="code" href="group__mfe__fold.html#gd11bb36c69e7e75f0bbae81a6642a015">fold</a>(seq2, struct2);

   <a class="code" href="group__mfe__fold.html#gb823f35d01c03e9c10823c0fd002c8f6">free_arrays</a>();     <span class="comment">/* free arrays used in fold() */</span>

   <span class="comment">/* produce tree and string representations for comparison */</span>
   xstruc = <a class="code" href="RNAstruct_8h.html#9ffcc30130c70ae29d780a8c1e5f6b25">expand_Full</a>(struct1);
   T1 = <a class="code" href="treedist_8h.html#f364f296fa9a725b009ffe85487c7f3f">make_tree</a>(xstruc);
   S1 = <a class="code" href="stringdist_8h.html#03f514f5a70a7b15e7e89cc05514fb98">Make_swString</a>(xstruc);
   free(xstruc);

   xstruc = <a class="code" href="RNAstruct_8h.html#9ffcc30130c70ae29d780a8c1e5f6b25">expand_Full</a>(struct2);
   T2 = <a class="code" href="treedist_8h.html#f364f296fa9a725b009ffe85487c7f3f">make_tree</a>(xstruc);
   S2 = <a class="code" href="stringdist_8h.html#03f514f5a70a7b15e7e89cc05514fb98">Make_swString</a>(xstruc);
   free(xstruc);

   <span class="comment">/* calculate tree edit distance and aligned structures with gaps */</span>
   <a class="code" href="dist__vars_8h.html#17ff12d422d6e292bf715cbcce0fdcbc">edit_backtrack</a> = 1;
   tree_dist = <a class="code" href="treedist_8h.html#18dc4c201254d05aff231de759a9f7c4">tree_edit_distance</a>(T1, T2);
   <a class="code" href="treedist_8h.html#a6583700fc10496e45b48a2b246702a9">free_tree</a>(T1); <a class="code" href="treedist_8h.html#a6583700fc10496e45b48a2b246702a9">free_tree</a>(T2);
   <a class="code" href="RNAstruct_8h.html#ad14cf08f537c6d25a636ab51a092470">unexpand_aligned_F</a>(aligned_line);
   printf(<span class="stringliteral">"%s\n%s  %3.2f\n"</span>, aligned_line[0], aligned_line[1], tree_dist);

   <span class="comment">/* same thing using string edit (alignment) distance */</span>
   string_dist = <a class="code" href="stringdist_8h.html#389803f56854a9247cd2ea2c61348a2d">string_edit_distance</a>(S1, S2);
   free(S1); free(S2);
   printf(<span class="stringliteral">"%s  mfe=%5.2f\n%s  mfe=%5.2f  dist=%3.2f\n"</span>,
          aligned_line[0], e1, aligned_line[1], e2, string_dist);

   <span class="comment">/* for longer sequences one should also set a scaling factor for</span>
<span class="comment">      partition function folding, e.g: */</span>
   kT = (<a class="code" href="fold__vars_8h.html#0b516316c5f7ab02f8d1a9fbc1ba2fbb">temperature</a>+273.15)*1.98717/1000.;  <span class="comment">/* kT in kcal/mol */</span>
   <a class="code" href="fold__vars_8h.html#1f54ec895a6e5961f82e188bafbea432">pf_scale</a> = exp(-e1/kT/strlen(seq1));

   <span class="comment">/* calculate partition function and base pair probabilities */</span>
   e1 = <a class="code" href="group__pf__fold.html#g25c82afd90b779becea09444dbe39bcf">pf_fold</a>(seq1, struct1);
   <span class="comment">/* get the base pair probability matrix for the previous run of pf_fold() */</span>
   bppm = <a class="code" href="group__pf__fold.html#g3a9f8c18a6043cfc8bbc30a8a37e3969">export_bppm</a>();
   pf1 = <a class="code" href="profiledist_8h.html#b19c3d52d27182862a0da09150a3f852">Make_bp_profile_bppm</a>(bppm, strlen(seq1));

   e2 = <a class="code" href="group__pf__fold.html#g25c82afd90b779becea09444dbe39bcf">pf_fold</a>(seq2, struct2);
   <span class="comment">/* get the base pair probability matrix for the previous run of pf_fold() */</span>
   bppm = <a class="code" href="group__pf__fold.html#g3a9f8c18a6043cfc8bbc30a8a37e3969">export_bppm</a>();
   pf2 = <a class="code" href="profiledist_8h.html#b19c3d52d27182862a0da09150a3f852">Make_bp_profile_bppm</a>(bppm, strlen(seq2));

   <a class="code" href="group__pf__fold.html#gba5cac9edbc48e9d0e8c8fe83f4d0781">free_pf_arrays</a>();  <span class="comment">/* free space allocated for pf_fold() */</span>

   profile_dist = <a class="code" href="profiledist_8h.html#e03b78cc482af7812f750c7f1cb2a40c">profile_edit_distance</a>(pf1, pf2);
   printf(<span class="stringliteral">"%s  free energy=%5.2f\n%s  free energy=%5.2f  dist=%3.2f\n"</span>,
          aligned_line[0], e1, aligned_line[1], e2, profile_dist);

   <a class="code" href="profiledist_8h.html#22d18ea73ab4faad46872bffa2fcb3de">free_profile</a>(pf1); <a class="code" href="profiledist_8h.html#22d18ea73ab4faad46872bffa2fcb3de">free_profile</a>(pf2);
}
</pre></div><p>
In a typical Unix environment you would compile this program using: <div class="fragment"><pre class="fragment">cc ${OPENMP_CFLAGS} -c example.c -I${hpath}
</pre></div> and link using <div class="fragment"><pre class="fragment">cc ${OPENMP_CFLAGS} -o example -L${lpath} -lRNA -lm
</pre></div> where <em>${hpath}</em> and <em>${lpath}</em> point to the location of the header files and library, respectively. <dl compact><dt><b>Note:</b></dt><dd>As default, the RNAlib is compiled with build-in <em>OpenMP</em> multithreading support. Thus, when linking your own object files to the library you have to pass the compiler specific <em>${OPENMP_CFLAGS}</em> (e.g. '-fopenmp' for <b>gcc</b>) even if your code does not use openmp specific code. However, in that case the <em>OpenMP</em> flags may be ommited when compiling example.c </dd></dl>
<hr size="1"><address style="align: right;"><small>Generated on Fri Jul 26 15:10:19 2013 for RNAlib-2.1.2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
