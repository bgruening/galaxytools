<tool id="preMloc" name="premlocarna" version="0.1.0" force_history_refresh="True">
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command>
        <![CDATA[

        cp ~/galaxytools/tools/EteriTools/PrepareForMlocarna/newpreMlocarna.pl ./ &&

        cp ~/galaxytools/tools/EteriTools/PrepareForMlocarna/pgma ./ &&

        cp ~/galaxytools/tools/EteriTools/PrepareForMlocarna/rnaclustScores2Dist.pl ./ &&

		    perl newpreMlocarna.pl  $CI $fast_cluster $fasta_data $fast_cluster_sim $data_map $knn


]]>
</command>
    <inputs>
        <param type="data" name="fast_cluster" label="fast_cluster" format="txt" help="stokholm format" />
        <param type="data" name="fasta_data" label="fasta_data" format="fasta" help="fasta format" />
        <param type="data" name="fast_cluster_sim" label="fast_cluster_sim" format="txt" help="similarity sclores" />
        <param type="data" name="data_map" label="data_map" format="txt" help="data map" />


        <param name="CI" type="integer" value="1" size="5" label="Number of current iteration ">
         <sanitizer>
                   <valid initial="string.printable">
                      <remove value="&apos;"/>
                   </valid>
               </sanitizer>
       </param>


        <param name="knn" type="integer" value="20" size="5" label="Number of nearest neighbors" help="must be the same as for previous step">
          <sanitizer>
            <valid initial="string.printable">
              <remove value="&apos;"/>
            </valid>
          </sanitizer>
        </param>



    </inputs>

    <outputs>

      <!--data format="fasta" name="centers">
        <discover_datasets pattern="(?P&lt;designation&gt;.+)\.fa" visible="true" directory="CLUSTER"  />
      </data>
      <data format="text" name="trees">
        <discover_datasets pattern="(?P&lt;designation&gt;.+)\.tree" visible="true" directory="CLUSTER" />
      </data-->

      <collection name="centers" type="list" format="fasta" label="centers">
      <discover_datasets pattern="(?P&lt;name&gt;^[0-9]*\.[0-9]*\.center.fa$)" directory="CLUSTER"  />
    </collection>
      <collection name="trees" type="list" format="text" label="trees">
      <discover_datasets pattern="(?P&lt;name&gt;^[0-9]*\.[0-9]*\.tree$)"  directory="CLUSTER" />
    </collection>

    <collection name="cmFa" type="list" format="text" label="cmfinder_fa" >
    <discover_datasets pattern="(?P&lt;name&gt;^[0-9]*\.[0-9]*\.cmfinder.fa$)"  directory="CLUSTER" hidden="true" />
  </collection>

    <!--collection name="outputs" type="list" format="gfClustzip" label="zipped Clusters">
      <discover_datasets pattern="__name_and_ext__" directory="CLUSTER" />
  </collection-->
    </outputs>

<!--
      All 1 test(s) executed passed.
      preMloc[0]: failed

      dont't know why?!
 -->

    <tests>
        <test>
            <param name="fast_cluster" value="data.svector.1.fast_cluster"/>
            <param name="fasta_data" value="data.fasta"/>
            <param name="fast_cluster_sim" value="data.svector.1.fast_cluster_sim"/>
            <param name="data_map" value="data.map"/>
            <param name="knn" value="20"/>
            <output_collection name="centers" type="list">
              <discover_datasets pattern="(?P&lt;name&gt;^[0-9]*\.[0-9]*\.center.fa$)" directory="CLUSTER"  />
            </output_collection>
            <output_collection name="trees" type="list">
              <discover_datasets pattern="(?P&lt;name&gt;^[0-9]*\.[0-9]*\.tree$)"  directory="CLUSTER" />
            </output_collection>
            <output_collection name="cmFa" type="list">
              <discover_datasets pattern="(?P&lt;name&gt;^[0-9]*\.[0-9]*\.cmfinder.fa$)"  directory="CLUSTER" hidden="true" />
            </output_collection>
        </test>
    </tests>
    <help>
        <![CDATA[

**What it does**

This tool prepares files for mlocarna step.

.. class:: warningmark

The number of nearest neighbors must be the same as in previous step (NSPDK step)

]]>
    </help>
    <citations>

      </citations>
</tool>
