<tool id="cmFinder" name="CMFinder_v0" version="0.1.0" >

  <requirements>
      <requirement type="package" version='0.2'>cmfinder</requirement>
      <requirement type="package" version='2.2.10'>viennarna</requirement>
  </requirements>

    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command>
        <![CDATA[

        python '$__tool_directory__/cmFinder.py' '$model_tree_stk' '$cmfinder_fa' '$__tool_directory__/'
        $gap_threshold_opts.gap_threshold_opts_selector
        #if str($gap_threshold_opts.gap_threshold_opts_selector) == '--g':
          $gap_threshold_opts.gap
        #end if

]]>
</command>
    <inputs>

     <!--param name="input1" type="data_collection" label="Input Collect" help="Input collection..." /-->
     <param name="model_tree_stk" type="data"  format="stockholm" label="model_tree_stk" help="" />
     <param name="cmfinder_fa" type="data"  format="text" label="cmfinder_fa" help="" />

        <conditional name="gap_threshold_opts">
            <param name="gap_threshold_opts_selector" type="select" label="Use gap threshold" help="">
                <option value="--g" selected="true">Yes (--g)</option>
                <option value="">No</option>
            </param>
            <when value="--g">
                <param name="gap" type="float" value="1.0" size="5"
                        label="Define the gap threshold to determine the conserved column (--g)" help="">
                    <sanitizer>
                        <valid initial="string.printable">
                            <remove value="&apos;"/>
                        </valid>
                    </sanitizer>
                </param>
            </when>
            <when value=""/>
        </conditional>
    </inputs>
    <outputs>
       <data name="model_cmfinder_stk" format="stockholm" label="model_cmfinder_stk" from_work_dir = "model.cmfinder.stk"/>
      <!--collection name="outputs" type_source="input1" format="zip" label="zipped Clusters">
       <discover_datasets pattern="__name_and_ext__" directory="CLUSTER" />
     </collection-->
    </outputs>
    <tests>
        <test>
            <param name="model_tree_stk" value="in.model.tree.stk"/>
            <param name="cmfinder_fa" value="cmfinder.fa"/>
            <param name="gap_threshold_opts.gap_threshold_opts_selector" value="--g"/>
            <param name="gap_threshold_opts.gap" value="1.0"/>
            <output name="model_cmfinder_stk" file="model.cmfinder.stk"/>
        </test>
    </tests>
    <help>
        <![CDATA[
Options:
	-b               Do not use BLAST search to locate anchors
	-v               Verbose. Print running information, and save intermediate results.
	-c <number>      The maximum number of candidates in each sequence. Default 40. No bigger than 100.
	-m <number>      The minimum length of candidates. Default 30
	-M <number>      The maximum length of candidates. Default 100
	-n <number>      The maximum number of output motifs. Default 3
	-f <number>      The fraction of the sequences expected to contain the motif. Default 0.80
	-s <number>      The number of stem-loops in the motif
	-h               Show this list
]]>
</help>
<citations>

  </citations>
</tool>
