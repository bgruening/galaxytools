<tool id="bioimage_inference" name="Load model from BioImage and make inferences" version="0.0.5">
    <description>using images</description>
    <requirements>
        <requirement type="package" version="3.9.12">python</requirement>
        <requirement type="package" version="2.1.2">pytorch</requirement>
        <requirement type="package" version="0.16.1">torchvision</requirement>
        <requirement type="package" version="3.0.8">cython</requirement>
    </requirements>
    <version_command>echo "@VERSION@"</version_command>
    <command detect_errors="aggressive">
<![CDATA[
        python '$__tool_directory__/main.py'

            --imaging_model '$input_imaging_model'
            --image_file '$input_image_file'
]]>
    </command>
    <inputs>
        <param name="input_imaging_model" type="data" format="zip" label="BioImage model" help="Please load a BioImage model from file uploader"/>
        <param name="input_image_file" type="data" format="npz" label="Image to be analysed" help="Please provide an image"/>

    </inputs>
    <outputs>
        <data format="png" name="output_predicted_image" from_work_dir="output_predicted_image.png" label="Predicted image"></data>
    </outputs>
    <tests>
        <test>
        </test>
    </tests>
    <help>
        <![CDATA[
**What it does**

The tool takes a BioImage model and an image to be analysed. Model makes a prediction and the predicted image becomes available as a PNG file.

**Description**
The tool takes a BioImage model and an image to be analysed. Model makes a prediction and the predicted image becomes available as a PNG file.

**Input files**
	- BioImage model: Add one of the model from Galaxy file uploader by choosing a "femote" file at "ML Models/bioimaging-models"
	- Image to be analysed: Pass an image in NPZ format

**Output file**
        - Predicted image: Predicted image using the Bioimage model

        ]]>
    </help>
    <citations>
        <citation type="bibtex">
            @ARTICLE{anuprulez_galaxytools,
                Author = {Anup Kumar and Beatriz Serrano-Solano and Björn Grüning},
                keywords = {imaging, deep learning},
                title = {{Inference using BioImage models}},
                url = {https://github.com/bgruening/galaxytools}
            }
        </citation>
    </citations>
</tool>
