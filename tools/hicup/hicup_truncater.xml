<tool id="hicup_truncater" name="Truncater" version="0.1.0">
    <requirements>
        <requirement type="package" version="0.5.9">hicup</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command><![CDATA[
        hicup_truncater --re1 $re1 $advanced_options.nofill 
        #if $advanced_options.index:
            --index $advanced_options.index
        #end if
        #if $advanced_options.sequences:
            --sequences $advanced_options.sequences
        #end if
        --threads $advanced_options.threads $advanced_options.zip
        #for $file_pair in $input_files:
            $file_pair.input_first_sequence $file_pair.input_second_sequence
        #end for
    ]]></command>
    <inputs>
         <repeat name="input_files" min="1" max="10000" title="Select input file(s):">
            <param name="input_first_sequence" type="data" format="fastq,fa" label="First input sequence" help="The first sequence for the truncater."/>
            <param name="input_second_sequence" type="data" format="fastq,fa" label="Second input sequence" help="The second sequence for the truncater."/>
        </repeat>
        <param argument="--re1" type="text" value="" label="Restriction enzyme recognition sequence" help="Restriction enzyme recognition sequence"/>
        <section name="advanced_options" title="Advanced options">        
            <param argument="--nofill" type="boolean" value="false" truevalue="--nofill" falsevalue="" label="No fill" help="Hi-C protocol did NOT include a fill-in of sticky ends prior to re-ligation and therefore reads shall be truncated at the restriction site sequence"/>
            <param argument="--sequences" type="text" value="" label="Ligation sequence" help="Instead of specifying a restriction enzyme recognition sequence, specify the ligation sequences directly"/>
            <param argument="--threads" type="integer" value="1" label="Threads" help="Specify the number of threads, allowing simultaneous processing of multiple files"/>
            <param argument="--zip" type="boolean" value="false" truevalue="--zip" falsevalue="" label="Compress output" help="Compress the output with zip"/>
        </section>
    </inputs>
    <outputs>
    <data format="txt" name="hicup_truncater_summary">
        <discover_datasets pattern="__designation_and_ext__" visible="true" />
    </data>
    </outputs>

    <help><![CDATA[

    For help please consult the documentation of HiCUP: http://www.bioinformatics.babraham.ac.uk/projects/hicup/overview/

    To get more information about the truncater visit: http://www.bioinformatics.babraham.ac.uk/projects/hicup/scripts_description/#Truncater
    ]]></help>

    <citations>
        <citation type="bibtex">
            @article{wingett2015hicup,
                title={HiCUP: pipeline for mapping and processing Hi-C data},
                author={Wingett, Steven and Ewels, Philip and Furlan-Magaril, Mayra and Nagano, Takashi and Schoenfelder, Stefan and Fraser, Peter and Andrews, Simon},
                journal={F1000Research},
                volume={4},
                year={2015},
                publisher={Faculty of 1000 Ltd}
                }
        </citation>
    </citations>
</tool>
