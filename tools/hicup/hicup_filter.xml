<tool id="hicup_filter" name="HiCUP Filter" version="0.1.0">
    <requirements>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command><![CDATA[
        hicup_filter --digest $digest $advanced_options.zip 
        #if $advanced_options.longest:
            --longest $advanced_options.longest
        #end if
        #if $advanced_options.shortest:
            --shortest $advanced_options.shortest
        #end if
        --threads $advanced_options.threads
         && mv hicup_filter_ditag_rejects* hicup_filter_ditag_rejects
    ]]></command>
    <inputs>
        <param argument="--digest" type="data" format="txt" label="Genome digest file" help="Specify the genome digest file (created by hicup_digester)"/>
        <section name="advanced_options" title="Advanced options">
            <param argument="--longest" type="text" value="" label="Max insert size" help="Maximum allowable insert size (bps)"/>
            <param argument="--shortest" type="text" value="" label="Min insert size" help="Minimum allowable insert size (bps)"/>
            <param argument="--threads" type="integer" value="1" label="Threads" help="Specify the number of threads, allowing simultaneous processing of multiple files"/>
            <param argument="--zip" type="boolean" value="false" truevalue="--zip" falsevalue="" label="Compress output" help="Compress the output with zip"/>
        </section>
    </inputs>
    <outputs>
    <data format="txt" name="hicup_filter_summary">
        <discover_datasets pattern="hicup_filter_summary" visible="true" />
    </data>
    <data format="sam" name="hicup_filter_result">
        <discover_datasets pattern="filt.sam" visible="true" />
    </data>
    <data format="bam" name="contiguous.filter">
        <discover_datasets pattern="contiguous.filter" directory="hicup_filter_ditag_rejects" visible="true" />
    </data>
    <data format="bam" name="circularised.filter">
        <discover_datasets pattern="circularised.filter" directory="hicup_filter_ditag_rejects" visible="true" />
    </data>
     <data format="bam" name="wrong_size.filter">
        <discover_datasets pattern="wrong_size.filter" directory="hicup_filter_ditag_rejects" visible="true" />
    </data>
     <data format="bam" name="invalid.filter">
        <discover_datasets pattern="invalid.filter" directory="hicup_filter_ditag_rejects" visible="true" />
    </data>
     <data format="bam" name="re_ligation.filter">
        <discover_datasets pattern="re_ligation.filter" directory="hicup_filter_ditag_rejects" visible="true" />
    </data>
     <data format="bam" name="same_dangling_ends.filter">
        <discover_datasets pattern="same_dangling_ends.filter" directory="hicup_filter_ditag_rejects" visible="true" />
    </data>
     <data format="bam" name="same_internal.filter">
        <discover_datasets pattern="same_internal.filter" directory="hicup_filter_ditag_rejects" visible="true" />
    </data>
    </outputs>

    
    <help><![CDATA[
The majority of reads generated by the HiCUP Mapper script are most likely valid Hi-C products, but a substantial minority are probably not and should be removed. The HiCUP Filter script processes paired reads together with the file created by HiCUP Digester to identify valid Hi-C pairs.

The names of the files to be processed and other parameters may be passed to the script using a configuration file or by command line arguments. As a minimum requirement the script requires: i) a list of HiCUP Mapper output file(s) and ii) a digested genome produced by HiCUP Digester. 
    ]]></help>
</tool>
