<tool id="hicup_digester" name="Digester" version="0.1.0">
    <requirements>
        <requirement type="package" version="0.5.9">hicup</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command><![CDATA[
        hicup_digester --re1 '$re1' --genome '$genome'
        #if $advanced_options.re2:
            --re2 '$advanced_options.re2'
        #end if
        #for $file in $inputFiles:
            $file
        #end for
        && mv *Digest_* digest_file.txt
    ]]></command>
    <inputs>
    <param name="inputFiles" type="data" multiple="true" format="fa" label="Input DNA sequence files that should be digested"/>
    <param argument="--re1" type="text" label="Restriction enzyme" help="Restriction enzyme used to digest the genome (the enzyme that 
            forms the ligation junction) e.g. A^GATCT,BglII.  Some Hi-C protocols may use two enzymes at this stage.  To specify two enzymes: -1 A^GATCT,BglII:A^AGCTT,HindIII."/>
    <param argument="--genome" type="text" label="Genome" help="Name of the genome to be digested (not the path to the genome 
            file or files, but the genome name to include in the output file)"/>
    <section name="advanced_options" title="Advanced options">
        <param argument="--re2" type="text" label="Restriction enzyme instead of sonication to shorten di-tags." help="To specify a restriction enzyme instead of sonication to
                shorten di-tags. This restriction site does NOT form a Hi-C ligation junction. 2 .g. AG^CT,AluI. Typically the sonication protocol is followed."/>
    </section>
    </inputs>
    <outputs>
        <data name="digest_file" format="txt" from_work_dir="digest_file.txt" label="digest_file.txt"/>
    </outputs>
     <tests>
        <test>
            <param name="own_file" value="ch1_reduced.fa"/>
            <param name="re1" value="A^AGCTT"/>
            <param name="genome" value="human"/>
            <output name="digest_file" file="digest_file.txt"/>
        </test>
    </tests>
    <help><![CDATA[

    For help please consult the documentation of HiCUP: http://www.bioinformatics.babraham.ac.uk/projects/hicup/overview/

    To get more information about the digister visit: http://www.bioinformatics.babraham.ac.uk/projects/hicup/scripts_description/#Digester
    ]]></help>
    <citations>
        <citation type="bibtex">
            @article{wingett2015hicup,
                title={HiCUP: pipeline for mapping and processing Hi-C data},
                author={Wingett, Steven and Ewels, Philip and Furlan-Magaril, Mayra and Nagano, Takashi and Schoenfelder, Stefan and Fraser, Peter and Andrews, Simon},
                journal={F1000Research},
                volume={4},
                year={2015},
                publisher={Faculty of 1000 Ltd}
                }
        </citation>
    </citations>
</tool>