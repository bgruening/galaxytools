<tool id="hicup_digester" name="HiCUP Digester" version="0.1.0">
    <requirements>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command><![CDATA[
        hicup_digester --re1 $re1 --genome $genome
        #if $advanced_options.re2:
            --re2 $advanced_options.re2
        #end if
        $advanced_options.zip 
        #for $file in $inputFiles:
            $file
        #end for
    ]]></command>
    <inputs>
    <param name="inputFiles" type="data" multiple="true" format="fa" label="Input DNA sequence files that should be digested"/>
    <param argument="--re1" type="text" label="Restriction enzyme" help="Restriction enzyme used to digest the genome (the enzyme that 
            forms the ligation junction) e.g. A^GATCT,BglII.  Some Hi-C protocols may use two enzymes at this stage.  To specify two enzymes: -1 A^GATCT,BglII:A^AGCTT,HindIII."/>
    <param argument="--genome" type="text" label="Genome" help="Name of the genome to be digested (not the path to the genome 
            file or files, but the genome name to include in the output file)"/>
    <section name="advanced_options" title="Advanced options">
        <param argument="--re2" type="text" label="Restriction enzyme instead of sonication to shorten di-tags." help="To specify a restriction enzyme instead of sonication to
                shorten di-tags. This restriction site does NOT form a Hi-C ligation junction. 2 .g. AG^CT,AluI. Typically the sonication protocol is followed."/>
        <param argument="--zip" type="boolean" value="false" truevalue="--zip" falsevalue="" label="Compress output" help="Compress the output with zip"/>
    </section>
    </inputs>
    <outputs>
    <data format="txt" name="digest_file">
        <discover_datasets pattern="__designation_and_ext__" visible="true" />
    </data>
    </outputs>
    <help><![CDATA[
    
The Perl script HiCUP Mapper generates a file of paired mapped reads. While the majority of those reads are expected to be valid Hi-C ligation products, a substantial minority probably will not and should be removed.

The script HiCUP Filter removes many of those invalid pairs, but before it can do this it requires a digested reference genome as input, along with the paired sequence files. The HiCUP Digester program cuts a selected reference genome with one or two specified Type II restriction enzymes that recognise single undivided palindromic sequences. The script prints the results to file for subsequent processing by HiCUP Filter.

The names of the files to be processed and the digestion parameters may be passed to the script by a configuration file or command line arguments. The configuration file contains: i) restriction site 1; ii) restriction site 2 (optional and an atypical choice of protocol); iii) the name of the genome to be processed (optional) and iv) list of FASTA files to be processed.
    ]]></help>
</tool>