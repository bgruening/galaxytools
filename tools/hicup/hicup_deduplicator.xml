<tool id="hicup_deduplicator" name="Deduplicator" version="0.1.0">
    <requirements>    
        <requirement type="package" version="0.5.9">hicup</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command><![CDATA[
        hicup_deduplicator --quiet '$input_file'
        && mv *.dedup.* dataset.dedup_result
        && mv hicup_deduplicator_summary* hicup_deduplicator_summary.txt
        && mv Rplots.pdf Rplots_deduplicator.pdf
    ]]></command>
    <inputs>
        <param name="input_file" type="data" format="bam,sam" label="Input file(s)" help="Input files in bam or sam format."/>
    </inputs>
    <outputs>
       <data name="dedup_result" format="bam,sam" label="dedup_result" from_work_dir="dataset.dedup_result" />
       <data name="hicup_deduplicator_summary" format="txt" label="hicup_deduplicator_summary" from_work_dir="hicup_deduplicator_summary.txt" />
       <data name='rplots' format="pdf" label="Rplots Deduplicator.pdf" from_work_dir="Rplots_deduplicator.pdf" />
    </outputs>
    <tests>
        <test>
            <param name="input_file" value="deduplicator_test_input.sam" ftype="sam" />
            <output name="dedup_result" file="dataset_dedup_result.sam" compare="sim_size" delta="50"/>
            <output name="hicup_deduplicator_summary" file="hicup_deduplicator_summary.txt" compare="sim_size" delta="50"/>
            <output name="rplots" file="Rplots_deduplicator.pdf" compare="sim_size" delta="50"/>
        </test>
    </tests>
    <help><![CDATA[

    For help please consult the documentation of HiCUP: http://www.bioinformatics.babraham.ac.uk/projects/hicup/overview/

    To get more information about the deduplicator visit: http://www.bioinformatics.babraham.ac.uk/projects/hicup/scripts_description/#Deduplicator
    ]]></help>
    <citations>
        <citation type="bibtex">
            @article{wingett2015hicup,
                title={HiCUP: pipeline for mapping and processing Hi-C data},
                author={Wingett, Steven and Ewels, Philip and Furlan-Magaril, Mayra and Nagano, Takashi and Schoenfelder, Stefan and Fraser, Peter and Andrews, Simon},
                journal={F1000Research},
                volume={4},
                year={2015},
                publisher={Faculty of 1000 Ltd}
                }
        </citation>
    </citations>
</tool>