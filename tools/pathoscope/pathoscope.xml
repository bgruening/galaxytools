<tool id="pathoscope" name="Pathoscope" version="@TOOL_VERSION@+galaxy@SUFFIX_VERSION@" profile="20.01">
    <description>species identification and strain attribution with unassembled sequencing data</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <expand macro="xrefs"/>
    <version_command>flye --version</version_command>
    <command detect_errors="exit_code"><![CDATA[
        mkdir -p pathoscope_output &&
        pathoscope $mode_conditional.mode_selector
        #if $mode_conditional.mode_selector == 'LIB'
            --online
            --outDir pathoscope_output
        #else if $mode_conditional.mode_selector == 'MAP'

    ]]></command>

    <inputs>
        <conditional name="mode_conditional">
            <param name="mode_selector" type="select" label="Pahoscope module" help="Pathoscope 2.0 consists of four core and two optional analysis modules for sequencing-based metagenomic profiling.">
                <option value="LIB">LIB: Taxon level reference genome Library creation module</option>
                <option value="MAP">MAP: PathoMap module</option>
                <option value="ID">ID: PathoID module</option>
                <option value="REP">REP: PathoReport module</option>
                <option value="QC">QC: Quality control for high throughput sequencing reads</option>
            </param>
            <when value="LIB">
                <param argument="--genomeFile" type="data" format="" label="" help="Specify the reference genome" />
                <param argument="--taxonIds" type="text" value="" label="Taxon IDs" help="Specify taxon ids of your interest with comma separated (if you have multiple taxon ids). If you do
                    not specify this option, it will work on all entries in the reference file. For taxonomy id lookup, refer to http://www.ncbi.nlm.nih.gov/taxonomy">
                    <sanitizer invalid_char="">
                        <valid initial="string.digits">
                            <add value="" />
                        </valid>
                    </sanitizer>
                    <validator type="regex">[0-9,]+</validator>
                </param>
                <param argument="--excludeTaxonIds" type="text" value="" label="Taxons IDs to exclude" help="Specify taxon ids to exclude with comma separated (if you have multiple taxon ids to exclude)">
                    <sanitizer invalid_char="">
                        <valid initial="string.digits">
                            <add value="" />
                        </valid>
                    </sanitizer>
                    <validator type="regex">[0-9,]+</validator>
                </param>
                <param argument="--noDesc" type="boolean" truevalue="--noDesc" falsevalue="" checked="false" label="Reduce FASTA headers" help="Do not keep an additional description in original
                    fasta seq header.Depending on NGS aligner, a long sequence header may slow down its mapping process" />
                <param argument="--subTax" type="boolean" truevalue="--subTax" falsevalue="" checked="false" label="Include all sub-taxonomies" help="Include all sub taxonomies under the query taxonomy ID" />
            </when>
            <when value="MAP">
                <conditional name="conditional_inputs">
                    <param name="" type="select" label="Input mode" help="Type of reads">
                        <option value="single">Single-end reads</option>
                        <option value="paired">Paired-end reads</option>
                    </param>
                    <when value="single">
                        <param argument="-U" type="data" format="fastq,fastqsanger" label="Input Read Fastq File (Unpaired/Single-end)"/>
                    </when>
                    <when value="paired">
                        <param argument="-1" type="data" format="fastq,fastqsanger" label="Input Read Fastq File (Pair 1)"/>
                        <param argument="-2" type="data" format="fastq,fastqsanger" label="Input Read Fastq File (Pair 2)"/>
                    </when>
                </conditional>
                <param argument="-targetRefFiles" type="data" format="fasta" multiple="true" label="Target reference genomes"/>
                <param argument="-filterRefFiles" type="data" format="fasta" multiple="true" label="Filter reference genomes"/>
                
            </when>
            <when value="ID">

            </when>
            <when value="REP">

            </when>
            <when value="QC">

            </when>
        </conditional>
    </inputs>
    <outputs>

    </outputs>
    <tests>

    </tests>
    <help><![CDATA[
Hello, world!
  ]]></help>
    <expand macro="citations" />
</tool>
