<tool id="bg_find_subsequences" name="Subsequence search" version="0.1">
    <description>providing regions in BED format</description>
    <requirements>
        <requirement type="package" version="1.6.5">biopyhon</requirement>
    </requirements>
    <command interpreter="python">
    <![CDATA[
        find_subsequences.py
            --input $input
            --output $output
            --pattern "$pattern"
            #if $input.ext == 'fasta':
                --format 'fasta'
            #else:
                --format 'fastq'
            #end if
    ]]>
    </command>
    <inputs>
        <param format="fasta,fastq" name="input" type="data" label="Sequence to be searched"
            help="This can be in FASTA or FASTQ format." />
        <param name="pattern" type="text" value="" label="Search pattern" help="For example GGATCC for BamH1.">
            <validator type="regex" message="Only letters are allowed.">^[a-zA-Z]+$</validator>
        </param>
    </inputs>
    <outputs>
        <data format="bed" name="output" />
    </outputs>
    <tests>
        <test>
            <param name="input" value="find_subsequences_input1.fasta" ftype="fasta"/>
            <param name="pattern" value="atcg"/>
            <output name="output" file="find_subsequences_simple_result1.bed" ftype="bed"/>
        </test>
        <test>
            <param name="input" value="find_subsequences_input1.fasta" ftype="fasta"/>
            <param name="pattern" value="atnncg"/>
            <output name="output" file="find_subsequences_advanced_result1.bed" ftype="bed"/>
        </test>
    </tests>
    <help>
<![CDATA[

**What it does**

Searches for a subsequence in a larger sequence. For example to get all restriction enzymes for BamH1.

If you are searching in a DNA sequence you can use ambiguous values using the standard 
`nucleotide ambiguity code <http://www.dnabaser.com/articles/IUPAC%20ambiguity%20codes.html>`_.

This tool is searching on both strands.

]]>
    </help>
    <citations>
        <citation type="doi">10.1093/bioinformatics/btp163</citation>
    </citations>
</tool>
