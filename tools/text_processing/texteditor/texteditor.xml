<tool id="texteditor" name="Text editor" version="0.1.0" python_template_version="3.5">
    <macros>
        <xml name="step_params">
            <conditional name="step">
                <param type="select" name="loc" label="">
                    <option value="Position"/>
                    <option value="String"/>
                </param>
                <when value="Position">
                    <param type="integer" name="line" value="" label="Line number"/>
                    <param type="integer" name="pos" value="" label="Character position in line"/>
                </when>
                <when value="String">
                    <param type="text" area="true" name="text" label="String" />
                    <param type="boolean" name="first" label="Apply to first occurrence of the text or all?" />
                </when>
            </conditional>
        </xml>
        <xml name="str_or_file">
            <conditional name="str_or_file">
                <param type="select" name="str_or_file" label="Insert a string or file?">
                    <option value="File"/>
                    <option value="String"/>
                </param>
                <when value="File">
                    <param type="data" name="File" />
                    <param type="integer" name="line_start" value="" label="Starting line"/>
                    <param type="integer" name="line_end" value="" label="Ending line"/>
                </when>
                <when value="String">
                    <param type="text" area="true" name="text" label="String" />
                </when>
            </conditional>
        </xml>
    </macros>
    
    <requirements>
    </requirements>

    <command detect_errors="exit_code"><![CDATA[

    ]]></command>
    <inputs>
	    <!-- <display>$data</display> -->
	    <!-- <param name="text" type="text" value="test" area="true"/> -->
        <param type="data" name="Input file"/>
        <repeat name="step" title="Add step">
            <conditional name="step_type">
                <param type="select" name="Type of edit">
                    <option value="insert">Insert text or file</option>
                    <option value="replace">Replace a string with text or file</option>
                    <option value="delete">Delete text</option>
                </param>
                <when value="insert">
                    <expand macro="step_params" />
                    <expand macro="str_or_file" />
                </when>
                <when value="replace">
                    <expand macro="step_params" />
                    <expand macro="str_or_file" />
                </when>
                <when value="delete">
                    <expand macro="step_params" />
                </when>
            </conditional>
        </repeat>
        
    </inputs>
    <outputs>
        <data format="html" name="output" />
    </outputs>
    <help><![CDATA[
        TODO: Fill in help.
    ]]></help>
</tool>
