<tool id="sklearn_pca" name="Principal component analysis" version="@VERSION@">
    <description>with scikit-learn</description>
    <macros>
        <import>main_macros.xml</import>
    </macros>
    <expand macro="python_requirements"/>
    <expand macro="macro_stdio"/>
    <version_command>echo "@VERSION@"</version_command>
    <command>
        <![CDATA[
        python "$pca_script" '$input'
        ]]>
    </command>
    <configfiles>
        <inputs name="inputs" />
        <configfile name="pca_script">
            <![CDATA[
import sys
import numpy as np
from sklearn.decomposition import PCA

inp = np.loadtxt(sys.argv[1])
pca = PCA()
outp = pca.fit_transform(inp)

np.savetxt("$outfile", outp)

            ]]>
        </configfile>
    </configfiles>
    <inputs>
        <param type="data" format="tabular" name="input"/>
    </inputs>
    <outputs>
        <data format="tabular" name="outfile"/>
    </outputs>
    <tests>
        <test>
            <param name="input" value="pca_input.dat"/>
            <output name="outfile" file="pca_output.dat"/>
        </test>
    </tests>
    <help>
        <![CDATA[

.. class:: infomark

**What it does**

This tool takes a tabular input file (one data point per row, each column a variable) 
and performs PCA using Singular Value Decomposition, returning an equally sized tabular 
file with the first PC in the first column, second PC in the second column, etc.

        ]]>
    </help>
    <expand macro="sklearn_citation"/>
</tool>
