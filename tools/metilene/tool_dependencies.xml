<?xml version="1.0"?>
<tool_dependency>
    <package name="perl" version="5.18.1">
        <repository name="package_perl_5_18" owner="iuc" prior_installation_required="False" />
    </package>
    <package name="R" version="3.2.1">
        <repository name="package_r_3_2_1" owner="iuc" />
    </package>
    <package name="bedtools" version="2.24">
        <repository name="package_bedtools_2_24" owner="iuc" />
    </package>
    <package name="gnu_coreutils" version="8.22">
        <repository name="package_gnu_coreutils_8_22" owner="iuc" />
    </package>

    <package name="metilene" version="0.2-4">
        <install version="1.0">
            <actions>

               <action type="setup_r_environment">
                   <repository name="package_r_3_2_1" owner="iuc" toolshed="https://toolshed.g2.bx.psu.edu">
                       <package name="R" version="3.2.1" />
                   </repository>
                   <package>https://github.com/bgruening/download_store/raw/master/blockclust/r-packages/ggplot2_0.9.3.1.tar.gz</package>
               </action>
 

              <!-- don't use download_by_url, since archive name != directory name --> 
              <action type="download_file">http://www.bioinf.uni-leipzig.de/Software/metilene/metilene_v02-4.tar.gz</action>
              <action type="shell_command">tar xfz metilene_v02-4.tar.gz</action>
              
              <action type="change_directory">metilene_v0.2-4</action>
              
              <action type="shell_command">make</action>
              
              <!-- move binary and scripts to installation bin directory -->
              <action type="move_file">
                  <source>metilene</source>
                  <destination>$INSTALL_DIR/bin</destination>
              </action>
              <action type="move_file">
                  <source>metilene_input.pl</source>
                  <destination>$INSTALL_DIR/bin</destination>
              </action>
              <action type="move_file">
                  <source>metilene_output.pl</source>
                  <destination>$INSTALL_DIR/bin</destination>
              </action>
              <action type="move_file">
                  <source>metilene_output.R</source>
                  <destination>$INSTALL_DIR/bin</destination>
              </action>

              <!-- include installation bin directory in path -->
              <action type="set_environment">
                <environment_variable name="PATH" action="prepend_to">$INSTALL_DIR/bin</environment_variable>
		<environment_variable name="METILENE_ROOT_PATH" action="set_to">$INSTALL_DIR</environment_variable>
              </action>
            </actions>
        </install>
        <readme>Metilene is precompiled for Linux</readme>
    </package>
</tool_dependency>
