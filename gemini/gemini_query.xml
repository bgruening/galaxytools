<tool id="gemini_@BINARY@" name="GEMINI @BINARY@" version="@version@.0">
    <description></description>
    <expand macro="requirements" />
    <expand macro="version_command" />
    <macros>
        <import>gemini_macros.xml</import>
        <token name="@BINARY@">query</token>
    </macros>
    <command>
<![CDATA[
        gemini @BINARY@

            #if $q.strip():
                -q "${q}"
            #end if

            #if $gt_filter.strip():
                --gt-filter "${gt_filter}"
            #end if

            #if $sample_filter.strip():
                --sample-filter "${sample_filter}"
            #end if

            $show_samples
            $show_families
            $family_wise
            $header
            $dgidb
            --in $in
            #if $region.strip():
                --region "${region}"
            #end if
            #if int($min_kindreds) > 0:
                --min-kindreds $min_kindreds
            #end if
            ##--format FORMAT       Format of output (JSON, TPED or default) # we will take default for the time being
            ##   --sample-delim STRING The delimiter to be used with the --show-samples option.




            "${ infile }"
            > "${ outfile }"
]]>
    </command>
                <!--
            ##TODO:
              - -carrier-summary-by-phenotype CARRIER_SUMMARY
                        Output columns of counts of carriers and non-carriers
                        stratified by the given sample phenotype column-->
    <expand macro="stdio" />
    <inputs>
        <param name="infile" type="data" format="sqlite" label="GEMINI database" />

        <param name="q" type="text" area="True" size="25x15" label="The query to be issued to the database"/>
        <param name="gt_filter" type="text" area="True" size="25x15" label="Restrictions to apply to genotype values"/>
        <param name="sample_filter" type="text" area="True" size="25x15" label="SQL filter to use to filter the sample table"/>
        <param name="sample_filter" type="text" area="True" size="25x15" label="SQL filter to use to filter the sample table"/>

        <param name="show_samples" type="boolean" truevalue="--show-samples" falsevalue="" checked="False" 
            label="Add a column of all sample names with a variant to each variant" help="(--show-samples)"/>

        <param name="show_families" type="boolean" truevalue="--show-families" falsevalue="" checked="False" 
            label="Add a column listing all of the families with a variant to each variant" help="(--show-families)"/>

        <param name="family_wise" type="boolean" truevalue="--family-wise" falsevalue="" checked="False" 
            label="Perform the sample-filter on a family-wise basis" help="(--family-wise)"/>

        <param name="header" type="boolean" truevalue="--header" falsevalue="" checked="False" 
            label="Add a header of column names to the output" help="(--header)"/>

        <!-- TODO: is there any default values set? -->
        <param name="min_kindreds" size="4" type="integer" value="-1" lebel="Minimum number of families for a variant passing a family-wise filter to be in" help="-1 means default values (--min-kindreds)" />

        <param name="dgidb" type="boolean" truevalue="--dgidb" falsevalue="" checked="False" 
            label="Request drug-gene interaction info from DGIdb" help="(--dgidb)"/>

        <param name="in" type="select" label="A variant must be in either all, none or any samples passing the sample-query filter" help="(--in)">
            <option value="all">all</option>
            <option value="none">none</option>
            <option value="any">any</option>
            <option value="only">only</option>
        </param>

        <param name="region" size="30" type="text" value="" label="Restrict query to this region" help="e.g. chr1:10-20 (--region)"/>


    </inputs>
    <outputs>
        <data name="outfile" format="tabular" label="${tool.name} on ${on_string}" />
    </outputs>
    <tests>
        <test>
        </test>
    </tests>
    <help>
**What it does**

The real power in the GEMINI framework lies in the fact that all of your genetic variants have been stored in a convenient database in the context of a wealth of genome annotations that facilitate variant interpretation. 
The expressive power of SQL allows one to pose intricate questions of oneâ€™s variation data. This tool offers you an easy way to query your variants!

.. _http://gemini.readthedocs.org/en/latest/content/querying.html

@CITATION@
    </help>
    <expand macro="citations"/>
</tool>
