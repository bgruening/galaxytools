<tool id="gemini_@BINARY@" name="GEMINI @BINARY@" version="@version@.0">
    <description>Extracting variants from specific regions or genes</description>
    <expand macro="requirements" />
    <expand macro="version_command" />
    <macros>
        <import>gemini_macros.xml</import>
        <token name="@BINARY@">region</token>
    </macros>
    <command>
<![CDATA[
        gemini @BINARY@

            #if $region.region_selector == '--reg':
                --reg "${region.region}"
            #else:
                --gene "${region.gene}
            #end if

            #if $report.report_selector != 'all':
                --columns "${report.columns}"
            #end if

            #if $filter.filter_selector == 'yes':
                --filter "${filter.filter}"
            #end if

            $header
            "${ infile }"
            > "${ outfile }"
]]>
    </command>
    <expand macro="stdio" />
    <inputs>
        <param name="infile" type="data" format="sqlite" label="GEMINI database" />

        <conditional name="region">
            <param name="region_selector" type="select" label="Select by ...?" help="">
                <option value="--reg">genomic coordinates</option>
                <option value="--gene">gene name</option>
            </param>
            <when value="--reg">
                <param name="region" type="text" label="Specify genomic region" help="e.g. chr1:100-200 (--reg)"/>
            </when>
            <when value="--gene">
                <param name="gene" type="text" label="Specify gene name" help="e.g. PTPN22 (--gene)" />
            </when>
        </conditional>

        <conditional name="report">
            <param name="report_selector" type="select" label="Columns to include in the report"
                help="By default, this tool reports all columns in the variants table. One may choose to report only a subset of the columns.">
                <option value="all" selected="True">all</option>
                <option value="column_filter">User given columns</option>
            </param>
            <when value="all"/>
            <when value="column_filter">
                <param name="columns" type="select" type="checkboxes" multiple="True" label="Choose columns to include in the report" help="(--columns)">
                    <option value="gene">gene</option>
                    <option value="chrom">chrom</option>
                    <option value="start">start</option>
                    <option value="end">end</option>
                    <option value="ref">ref</option>
                    <option value="alt">alt</option>
                    <option value="impact">impact</option>
                    <option value="impact_severity">impact_severity</option>
                </param>
            </when>
        </conditional>

        <conditional name="filter">
            <param name="filter_selector" type="select" label="Apply additional constraints"
                help="By default, this tool will report all variants regardless of their putative functional impact. In order to apply additional constraints on the variants returned, you can this optional filter.">
                <option value="no">No additional constraints</option>
                <option value="yes">Apply additional constraints</option>
            </param>
            <when value="no"/>
            <when value="yes">
                <param name="filter" type="text" label="Contraints in SQL syntax" help="Conditions applied here will become WHERE clauses in the query issued to the GEMINI database. E.g. alt='G'. (--filter)" />
            </when>
        </conditional>

        <expand macro="add_header_column" />

    </inputs>
    <outputs>
        <data name="outfile" format="tabular" label="${tool.name} on ${on_string}" />
    </outputs>
    <tests>
        <test>
        </test>
    </tests>
    <help>
**What it does**

One often is concerned with variants found solely in a particular gene or genomic region.

@CITATION@
    </help>
    <expand macro="citations"/>
</tool>
